"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}define("bomUp",["jquery","xlsxFull","layer-all","jl-modal"],function(B){var p,g=layui.form,m=require("jl-modal");return function(a){var r=a.self,i=B(r).data("type");var c=null;function l(n,e,t,a){var r=n[2]?n[2]:JSON.parse(window.sessionStorage.getItem("bom_searchData")),i=r||[],o=0<i.length?i:[{name:"品牌,brand,Agents,制造商,厂家,厂牌,代理,制造商,廠家,廠牌",code:"brand"},{name:"分类,功能,参数,spec,specification,性能,规格,分類,功能,參數,規格",code:"cate"},{name:"封装,封裝,Package",code:"package"},{name:"数量,QTY,quantity,Q,采购量,量,单机用量,单板用量,數量采購量,量,單機用量,單板用量",code:"pnum"},{name:"型号,part,物料,厂商,P/N,num,product,item,来料,number,type,name,typ,part_number,用料,品名,名称,品种,型號,廠商,來料,名稱,品種",code:"p_sign"}],c={},l=[],u=[],s=[],f=B.extend(!0,[],e?function(r,i){if("object"===(void 0===r?"undefined":_typeof(r))&&"object"===(void 0===i?"undefined":_typeof(i)))return B.each(r,function(t,a){B.each(i,function(e,n){n.code===a.code&&(r[t]=i[e])})}),r;layer.msg("参数错误")}([{name:"需求品牌",code:"brand"},{name:"需求功能分类",code:"cate"},{name:"需求封装",code:"package"},{name:"需求数量",code:"pnum"},{name:"需求型号",code:"p_sign"}],0<i.length?o:[]):o),p={},g=[],m=function(t,e){var n=e.split(","),a=!1;return n.forEach(function(e,n){if(-1<t.toLocaleUpperCase().indexOf(e.toLocaleUpperCase()))return!(a=!0)}),a};if(t)return f.forEach(function(t,e){var a={};B.each(n[0],function(e,n){n.v&&"null"!=n.v&&t.name&&m(n.v+"",t.name)&&(a[t]=!0)}),B.isEmptyObject(a)||g.push(a)}),f.length==g.length;var h=[],v=function(r,i){var o=0;return B.each(n[0],function(e,n){var t=e.indexOf("!")<0?e.replace(/[0-9]/gi,""):"";if(t&&B.inArray(t,h)<0&&h.push(t),i&&e.indexOf("!")<0)for(var a=0;a<i.length;a++)-1<e.indexOf(i[a]+r)&&o++;else i=[]}),o===i.length?{array:h,max_length:!0}:{array:h,max_length:!1}},d=[],y=-1;if(B.each(n[0],function(t,a){var e=t.replace(/[0-9]/gi,"");p[e]?p[e].push({totalIndex:e,position:t,keyValue:String(a.v)}):p[e]=[{totalIndex:e,position:t,keyValue:String(a.v)}],f.forEach(function(e,n){a.v&&"null"!=a.v&&m(a.v+"",e.name)&&(a.v+"").length<20&&(v(a.v,v().array).max_length&&(y<0&&(y=t.replace(/[^0-9]/gi,"")),d.push(t.replace(/[0-9]/gi,"")),t.replace(/[^0-9]/gi,"")<10&&l.push({totalIndex:t.replace(/[0-9]/gi,""),position:t,keyValue:String(a.v),keyCode:e.code})),t.replace(/[^0-9]/gi,"")<10&&s.push(t.replace(/[0-9]/gi,"")))})}),s=Array.from(new Set(s)),l=function(e){if(e instanceof Array){var a={};e.forEach(function(e,n){if(e.position){var t=e.position.replace(/[^0-9]/gi,"");a[t]?a[t]=++a[t]:a[t]=1}});var t={max:0,value:""};for(var n in a)t.max<a[n]&&(t.max=a[n],t.value=n);var r=[];return e.forEach(function(e,n){e.position&&e.position.replace(/[^0-9]/gi,"")-t.value==0&&r.push(e)}),r}layer.msg("参数格式错误")}(l),a){var b=[];return B.each(n[0],function(e,n){y==e.replace(/[^0-9]/gi,"")&&B.inArray(n.v,b)<0&&b.push(n.v)}),b}B.each(s,function(e,t){B.each(n[0],function(e,n){t==e.replace(/[0-9]/gi,"")&&u.push({row:t,name:n.v,line:e.replace(/[^0-9]/gi,""),position:e})})});var _=[];if(B.each(l,function(e,t){var a=[],r=0;B.each(u,function(e,n){B.inArray(n.line,_)<0&&_.push(n.line),t.totalIndex==n.row&&(0!=r&&a.push({name:t.keyValue,value:n.name,cols:n.row,line:n.line}),r++)}),c[t.keyCode]?c[t.keyCode]=c[t.keyCode].concat(a):c[t.keyCode]=a,a=null}),!c.p_sign)if(c.cate)c.p_sign=c.cate,delete c.cate;else{var x=[],S="A";B.each(p,function(t,e){if(t.indexOf("ref")<0&&t.indexOf("margins")<0){if(S!==String(t)&&(S=String(t)),B.each(e,function(e,n){if(/[A-Za-z]+/gi.test(n.keyValue)&&S===t)x.push({cols:n.position.replace(/[0-9]/gi,""),line:n.position.replace(/[^0-9]/gi,""),name:"需求型号",value:n.keyValue});else if(1<x.length)return!1}),2<x.length)return!1;x=[]}}),c.p_sign=x}var A=[];_=_.sort(function(e,n){return e-n});for(var E=1;E<_.length;E++){var k={};B.each(c,function(t,e){if(B.isArray(e)){var a={};B.each(e,function(e,n){_[E]==n.line&&(a[t]?a[t].push(n):a[t]=[n])}),k=B.extend({},k,a)}}),B.isEmptyObject(k)||A.push(k)}var C={},O={cate:{},package:{},brand:{}},j={char_cols:{}};A.forEach(function(t,a){B.each(t,function(e,n){1<n.length&&(A[a][e]=t[e]=function(e){if("object"===(void 0===e?"undefined":_typeof(e))){var n=[];return e.forEach(function(t,e){if(n.length<1)n.push(t);else{var a=0;B.each(n,function(e,n){n.name===t.name&&n.value===t.value&&n.line===t.line||a++}),a===n.length&&n.push(t)}}),n}layer.msg("参数错误")}(n))})}),A.forEach(function(e,n){var t,a;e.p_sign&&(t=e.p_sign,a=n,t instanceof Array?B.each(t,function(e,n){if(!n.value)return!0;/^[0-9_-]+(\t)*$/gi.test(n.value)||(/^[\u2E80-\u9FFF]+$/gi.test(n.value.trim())?(n.text_count,n.text_count+=1):/[\u2E80-\u9FFF]+/gi.test(n.value)&&/(IC)|(PCB)|(DC)|(PUR)/gi.test(n.value)||(/(\s)|(,)|(\|)|(\/)/gi.test(n.value.trim())?j.char_cols.count?(j.char_cols.count++,j.char_cols.value[a]=n):j.char_cols={cols:n.cols,count:1,value:[n]}:C[n.cols]?C[n.cols].count+=1:(n.count=1,C[n.cols]=n)))}):layer.msg("匹配型号数据错误"))});var F={},w=0,L={},U={cate:{optimal:{},max_length:0},brand:{optimal:{},max_length:0},package:{optimal:{},max_length:0}};for(var D in C){var I=/^[\u2E80-\u9FFF]+$/gi,N=/^[0-9_-]+(\t)*$/gi;N.test(C[D])?L.self_number=B.extend({},C[D]):I.test(C[D])?L.self_text=B.extend({},C[D]):B.isEmptyObject(F.value)&&(F=B.extend({},C[D])),w<=C[D].count&&!I.test(C[D])&&!N.test(C[D])&&(w=C[D].count,F=B.extend({},C[D]))}B.isEmptyObject(F)&&(!B.isEmptyObject(L.self_number)&&(F=B.extend({},L.self_number)),!B.isEmptyObject(L.self_text)&&(F=B.extend({},L.self_text))),B.each(O,function(e,n){if(!B.isEmptyObject(n))for(var t in n)U[e].max_length<=n[t].count&&(U[e].max_length=n[t].count,U[e].optimal=B.extend({},n[t]))});var $=[];A.forEach(function(e,t){e.p_sign?($[t]=e.p_sign,B.each(e.p_sign,function(e,n){if(F.cols===n.cols)return!(A[t].p_sign=[n]);A[t].p_sign=[]})):$[t]=[]});var T=function(t,e){if(!(!e instanceof Array)){var a={};return B.each(e,function(e,n){t!==n.cols||(a=B.extend(!0,{},n))}),1===e.length&&B.isEmptyObject(a)&&(a=e[0]),a}layer.msg("参数错误")};(!F.cols||F.count<.2*A.length)&&A.forEach(function(e,n){e.p_sign&&j.char_cols.cols&&(j.char_cols.cols?A[n].p_sign[0]=T(j.char_cols.cols,$[n]):A[n].p_sign=[])}),A.forEach(function(t,a){["p_sign","cate","package","pnum","brand"].forEach(function(e,n){t[e]?1<t[e].length&&(A[a][e].length=1):A[a][e]=[]})});var X=function(e){if("object"===(void 0===e?"undefined":_typeof(e))){var t=0;return B.each(e,function(e,n){n.count&&t<=n.count&&(t=n.count)}),t}layer.msg("参数错误")},P={MatchingScore:0,text_letter:0},z=0,V={rule1:{0:{value:"",count:1},count:1},rule2:{AA:{value:"",count:1},count:1}};return B.each(A,function(e,n){var r=/^[\u2E80-\u9FFF]+$/gi,i=/[\u2E80-\u9FFF]+/gi,o=/(IC)|(PCB)|(DC)|(PUR)/gi,c=/^[0-9]*[\u2E80-\u9FFF]*[0-9]*(\t)*$/gi,l=/^[a-zA-Z]*[\u2E80-\u9FFF]*[a-zA-Z]*(\t)*$/gi,u=/[-.\t()（）]*/gi;n.p_sign&&B.each(n.p_sign,function(e,n){0===e&&z++,(c.test((n.value+"").replace(u,""))||r.test((n.value+"").replace(u,""))||i.test((n.value+"").replace(u,""))&&o.test((n.value+"").replace(u,"")))&&P.MatchingScore++,l.test((n.value+"").replace(u,""))&&P.text_letter++;var t=String(n.value).length||0;V.rule1[t]?V.rule1[t].count++:V.rule1[t]={value:String(n.value),count:1},V.rule1.count=X(V.rule1);var a=String(n.value).replace(String(n.value).substr(1,String(n.value).length-2),"");V.rule2[a]?V.rule2[a].count++:V.rule2[a]={value:a,count:1},V.rule2.count=X(V.rule2)})}),(P.MatchingScore>=.8*z||V.rule1.count>=(50<z?.8*z:.6*z)||V.rule2.count>=.8*z||P.text_letter>=.8*z)&&A.forEach(function(t,a){if(t.p_sign){var r=function(e){if(!(!e instanceof Object)){var t={count:0,cols:""},a={count:0,cols:""},r=0;return B.each(e,function(e,n){r++,n.count>t.count?(a=t,t=n):n.count>a.count&&(a=n)}),{second:a,first:t,many:r}}layer.msg("数据错误")}(C);B.each($[a],function(e,n){if(!B.isEmptyObject(C)&&r.second.cols===n.cols&&1<r.many&&r.second.count>.8*z)return A[a].p_sign[0]=n,!1;t.p_sign[0]&&0<t.cate.length?A[a].p_sign=[t.cate[0]]:j.char_cols.cols?A[a].p_sign[0]=T(j.char_cols.cols,$[a]):A[a].p_sign||(A[a].p_sign=[])})}}),A}function u(e,n,t){"object"!==(void 0===e?"undefined":_typeof(e))&&layer.msg("返回数据格式错误");var i=[],s=[],a=[e.sendData,e.num,e.bom],r=a[0],f=a[2],p=t||["cate","brand","package"];r&&B.each(r,function(o,c){var l=[[],[],[],[],[],[],[]],u={};B.each(p,function(e,n){var m,t,a,h,v,d,y,b,_,x,r,i,S,A;l[5]&&0<l[5].length&&"package"===n&&(c[n]?c[n]=c[n].concat(l[5]):c[n]=l[5]),c[n]&&0<c[n].length&&c[n][0].value&&(t=o,a=c[m=n],h={blur_length:l[4],blur:l[0],complete:l[2],replace:l[3],contain:l[6]},v=[],d={},y=[],b=[],_=[],x=[],r={},i="p_sign"!==m?h.blur:f[t].blur,S=function(t,e){if(!(t&&e instanceof Array))return layer.msg("参数错误1");var a=!1;return e.forEach(function(e,n){t===e.id&&(a=!0)}),a},A=function(t,e){if("object"!==(void 0===e?"undefined":_typeof(e))||"object"!==(void 0===t?"undefined":_typeof(t)))return layer.msg("参数错误2"),[];var n=B.extend(!0,[],e);if(t.id){var a=-1;B.each(e,function(e,n){if(n.id===t.id)return a=e,!1}),-1<a&&(n.splice(a,1),n.unshift(t))}return n},B.each(a,function(e,f){var p=0,g="";if(/(^[0-9]+$)|(^[\u2E80-\u9FFF]+$)/gi.test(f.value)&&"p_sign"===m||!f.value)return!0;B.each(i,function(e,t){var n="";if(t[m]||t[m+"_name"]){if("package"===m||"p_sign"===m){var a=E(t[m].trim(),t.package.trim()),r=t[m].split(a)[0].trim();n=E(String(f.value).trim(),"p_sign"===m?r:t.package.trim())}else n=E(String(f.value).trim(),t[m+"_name"].trim());if((3<=(n=n.replace(/[-]*/gi,"")).length||-1<n.toLocaleUpperCase().indexOf(String(f.value).toLocaleUpperCase().trim()))&&"p_sign"===m){var i=E(String(f.value).trim(),t.package.trim());if(3<i.length){if(-1<n.toLocaleUpperCase().indexOf(i.toLocaleUpperCase().trim()))return!0;y.push({value:i})}var o=/(-)/gi;r.replace(o,"").toLocaleUpperCase()===String(f.value).replace(o,"").toLocaleUpperCase().trim()||String(f.value).toLocaleUpperCase().trim()===t[m].toLocaleUpperCase()?0<b.length&&S(t.id,b)||(b.push(t),S(t.id,v),v.unshift(t)):-1<t[m].replace(o,"").toLocaleUpperCase().indexOf(String(f.value).toLocaleUpperCase().replace(o,"").trim())?0<_.length&&S(t.id,_)||(_.push(t),S(t.id,v),v.unshift(t)):p<=n.length?(p=n.length,!f.add&&(g=f.value),0<v.length&&S(t.id,v)||(v.unshift(t),d[n.length]?d[n.length].push(t):d[n.length]=[t])):0<v.length&&S(t.id,v)||(v.push(t),d[n.length]?d[n.length].push(t):d[n.length]=[t])}if("p_sign"===m){var c="",l="",u=t.fitemno_access.split("{}");t[m]&&0<u.length&&B.each(u,function(e,n){0<e&&("package"!==m&&"p_sign"!==m||(c=E(String(f.value).trim(),n.trim())),-1<n.toLocaleUpperCase().indexOf(String(f.value).toLocaleUpperCase().trim())&&3<c.length&&!l&&(l=c))}),3<=l.length&&(0<x.length&&S(t.id,x)||x.push(t))}else if(p<=n.length){if(p=n.length,!f.add&&(g=f.value),h.blur){v=A(t,h.blur);var s=B.isEmptyObject(d)?B.extend(!0,{},h.blur_length):d;B.each(s,function(e,n){f&&(d[e]=A(t,n))})}h.complete&&(b=A(t,h.complete)),h.replace&&(x=A(t,h.replace)),h.contain&&(_=A(t,h.contain))}}}),r[m]=g?String(g).trim():""}),B.each(d,function(e,n){20<e.length&&(d[n].length=20)}),0<y.length&&(y=function(e){if(e instanceof Array){var t=[],a={};return e.forEach(function(e,n){a[e.value]||(a[e.value]=!0,t.push(e))}),t}layer.msg("参数错误")}(y)),l=["p_sign"===m&&40<v.length?v.splice(0,40):v,r,b,x,d||{},y||[],_||[]],u=B.extend(u,l[1]))});var a=[];if(!B.isEmptyObject(l[4])){var e=Object.keys(l[4]).sort(function(e,n){return e-n}).reverse();c.package||(c.package=[]),e.forEach(function(e,n){var t=0<c.package.length?function(e){if("object"!==(void 0===e?"undefined":_typeof(e)))return layer.msg("参数错误3"),[];var t=["明智类比"],n=B.extend(!0,[],e);if(0<e.length){var a=-1;B.each(e,function(e,n){if(n.brand_name&&t[0]===n.brand_name.trim())return a=e,!1}),-1<a&&(n.splice(a,1),n.unshift(e[a]))}return n}(l[4][e]):l[4][e];a=a.concat(t)})}var n={blur:a||[],complete:l[2]||[],replace:l[3]||[]},t=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];if(e instanceof Array&&n instanceof Array&&a instanceof Array){var r=[],i=[];if(0<n.length&&B.each(e,function(t,e){B.each(n,function(e,n){t.id!==e.id&&r.push(t)})}),0<a.length){var t=0<n.length?r:e;B.each(t,function(t,e){0<a.length&&B.each(a,function(e,n){t.id!==e.id&&i.push(t)})})}return n.length<1&&a.length<1?e:0<a.length?i:r}layer.msg("参数类型错误")};0<n.replace.length&&0<n.complete.length&&(n.replace=t(n.replace,n.complete)),0<l[6].length&&(n.complete=[].concat(_toConsumableArray(n.complete),_toConsumableArray(l[6]))),(0<n.complete.length||0<l[6].length)&&(n.complete=[].concat(_toConsumableArray(n.complete),_toConsumableArray(n.replace)),n.replace=[]),n.blur=t(n.blur,n.complete,n.replace);var r=[].concat(_toConsumableArray(n.complete),_toConsumableArray(n.replace),_toConsumableArray(n.blur));i.push({blur:r||[],mistyNum:n.blur||[],complete:n.complete||[],replace:n.replace||[]}),s[o]=u}),n&&n([i,s])}function E(e,n,t){var a=function(e,n){if(e.length>n.length){var t=e;e=n,n=t}for(var a=e.length,r=(n.length,a);0<=r;r--)for(var i=0;i<=a-r;i++){var o=e.substr(i,r);if(0<=n.toLocaleUpperCase().indexOf(o.toLocaleUpperCase()))return o}return""};if(t){var r=n.split("-");return{before:a(e,r[0]||""),after:a(e,r[1]||"")}}return a(e,n)}function s(n,e,t){c=layer.open({type:3,icon:2,content:'<div style="color:#fff;margin-left:120px;height:100px;line-height:100px"> '+(a.sample?"数据导入中":"数据解析中")+"...</div>",success:function(){B(".layui-layer-content.layui-layer-loading2").css({width:"300px",height:"100px","background-color":"#999","background-position":"74px center"})}});var r,i,o=t?n[0]:l(n,e);if(o.length<1)return layer.close(c),void layer.msg("没有匹配到任何数据");r=o,i=function(e){var t={};o.forEach(function(e,n){var t=[],a=[];e.cate&&B.each(e.cate,function(e,n){n.add||t.push(n)}),e.brand&&B.each(e.brand,function(e,n){n.add||a.push(n)}),o[n].cate=t,o[n].brand=a}),t.sendData=o,t.showData=e[1],t.name=n[1],t.bom=e[0],0<t.bom.length&&B.each(t.bom,function(e,n){n.blur?50<n.blur.length&&(120<t.bom.length?(t.bom[e].blur.length=10,t.bom[e].mistyNum.length=10):(t.bom[e].blur.length=50,t.bom[e].mistyNum.length=50)):t.bom[e]={blur:[],complete:[],replace:[]}}),a.sample?a.fn(t):a.mendData?a.fn(t):(window.sessionStorage.setItem("bomData",JSON.stringify(t)),setTimeout(function(){layer.close(c),window.location.href="/Home/Default/bomPrice?action=match"},10))},B.getJSON("/productBom.json",function(t){if(console.log("json",t),t instanceof Array){var a={};r.forEach(function(e,n){a[n]={blur:t}}),u({bom:a,sendData:r,num:{}},function(e){i&&i(e)},["p_sign","cate","brand","package"])}else layer.msg("本地商品数据错误！！！")})}var o=function(n){var e=window.sessionStorage.getItem("bom_searchData"),t=e?JSON.parse(e):[{name:"",code:"p_sign"},{name:"",code:"package"},{name:"",code:"brand"},{name:"",code:"cate"},{name:"",code:"pnum"}],i={};t instanceof Array?B.each(t,function(e,n){i[n.code]=n.name}):i=t;var a,o,r='<form class="layui-form">'+(a=l(n,!1,!1,!0),o="",B.each(a,function(e,n){var a,r;o+='<div class="layui-form-item">\n    <label class="layui-form-label">'+n+'</label>\n    <div class="layui-input-block">\n      <select name="'+n+'" lay-verify="required">\n        <option value=""></option>\n'+(a=n,r="",B.each([{name:"需求型号",code:"p_sign"},{name:"需求封装",code:"package"},{name:"需求品牌",code:"brand"},{name:"需求分类",code:"cate"},{name:"需求数量",code:"pnum"}],function(e,n){if(i[n.code]){var t=i[n.code].split(",");-1<B.inArray(a,t)?r+='<option value="'+n.code+'" selected>'+n.name+"</option>":r+='<option value="'+n.code+'">'+n.name+"</option>"}else r+='<option value="'+n.code+'">'+n.name+"</option>"}),r)+"      </select>\n    </div>\n  </div>"}),o)+"</form>";m.confirm({title:"表头字段匹配填写",brief:r,width:"26vw",height:"auto",maxHeight:"60vh",isCenter:!0,confirm:function(){window.sessionStorage.removeItem("bom_searchData");var e=B(".layui-form").serializeArray(),t=[],a={};e.forEach(function(e,n){e.value&&(a[e.value]?a[e.value]=a[e.value]+","+e.name:a[e.value]=e.name+"")}),B.each(a,function(e,n){t.push({name:n,code:e})}),n.push(t),s(n,!0),m.close()}}),B(".layui-form label").css("width","60px"),g.render()};if(a.importExcel){var e=a.importExcelData;s(e[0],e[1],e[2])}else{var n=r.files[0].name.split(".")[r.files[0].name.split(".").length-1];if(B("#_file_path").val(r.files[0].name),"xls"==n||"xlsx"==n)if(5e3<r.files[0].size/1024)alert("The file can not over 4MB");else{var f=r.files[0],t=new FileReader;t.readAsBinaryString(f),t.onload=function(e){var n=e.target.result;p=XLSX.read(n,{type:"binary"});var t=function(t){var a="";B.each(p.SheetNames,function(e,n){a+=e<1?'<input type="radio" name="sheet" value="'+n+'" title="'+n+'" checked>':'<input type="radio" name="sheet" value="'+n+'" title="'+n+'">'}),m.confirm({title:"选择上传表",brief:'<form class="layui-form self-select"><div class="layui-form-item">\n    <div class="layui-input-block" style="margin-left:0">\n'+a+"    </div>\n  </div></form>",confirmText:"确定",confirm:function(){var e=B(".self-select").serializeArray()[0].value,n=p.Sheets[e];t&&t(n)}}),g.render()};t(function(e){"standard"==i?l([e],!0,!0)?t(function(e){s([e,f.name],!0)}):m.confirm({title:"温馨提示",brief:"非商城标准格式，如继续上传，可能会影响准确性",confirmText:"继续上传",cancelText:"取消",top:100,confirm:function(){s([e,f.name],!0)},cancel:function(){}}):m.confirm({title:"温馨提示",brief:"是否先按商城需求定义表格字段，可以提升匹配准确性",confirmText:"是",cancelText:"继续上传",top:100,confirm:function(){o([e,f.name])},cancel:function(){s([e,f.name])}})}),window.ActiveXObject||"ActiveXObject"in window?B(r).replaceWith(B(r).clone(!0)):B(r).val("")},"{}"===JSON.stringify(XLSX)&&make_xlsx_lib(XLSX)}else layer.msg("Only support excel!")}}});