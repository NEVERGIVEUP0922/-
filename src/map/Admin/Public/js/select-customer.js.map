{"version":3,"sources":["Admin/Public/js/select-customer.js"],"names":["layui","define","exports","active_data","layer","table","form","laypage","getData","query","callback","$","get","res","parseJSON","error","data","tips","msg","renderTable","console","log","list","render","elem","page","limit","pageSize","cellMinWidth","height","cols","field","width","fixed","templet","title","d","company","company_name","on","prop","renderPage","find","count","curr","layout","jump","obj","first","search","val","trim","name","start","open","type","area","content","success","click","yes","index","layero","$checked","length","eq","parent","close","initInput","selector","need","_this","this","$this","id","siblings"],"mappings":"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","file":"../../../../../temporaryJs/Admin/Public/js/select-customer.js","sourcesContent":["'use strict';\n\nlayui.define(['layer', 'table', 'form', 'laypage'], function (exports) {\n    var layer = layui.layer;\n    var table = layui.table;\n    var form = layui.form;\n    var laypage = layui.laypage;\n    //\n    var active_data;\n    var getData = function getData(query, callback) {\n        $.get('/Admin/Customer/customerList', query, function (res) {\n            res = $.parseJSON(res);\n            if (res.error === 0) {\n                active_data = res.data;\n                callback(res.data);\n            } else {\n                layer.tips(res.msg, '.modal-search-btn');\n            }\n        });\n    };\n\n    var renderTable = function renderTable(data) {\n        console.log(\"datalist\", data.list);\n        table.render({\n            elem: '.select-modal-table',\n            data: data.list,\n            page: false,\n            limit: data.pageSize,\n            cellMinWidth: 160,\n            height: '320',\n            cols: [[{ field: 'checkbox', width: 50, fixed: 'left', templet: '<div><input class=\"select-modal-checkbox\" lay-filter=\"c_check\" type=\"checkbox\" name=\"\" lay-skin=\"primary\"></div>' }, { field: 'id', title: 'id', width: 160 }, { field: 'user_name', title: '客户账号', width: 160 }, { field: 'nick_name', title: '客户名称', width: 160, templet: function templet(d) {\n                    return d.company ? d.company.company_name : '';\n                } }, { field: 'nick_name', title: '公司名称', width: 160 }, { field: 'user_mobile', title: '联系电话', width: 160 }, { field: 'user_type', title: '客户类型', width: 160 }]]\n        });\n        form.on('checkbox(c_check)', function (data) {\n            var $checkboxs = $('.select-modal-checkbox');\n            $checkboxs.prop('checked', false);\n            $(data.elem).prop('checked', true);\n            form.render('checkbox');\n        });\n    };\n    var renderPage = function renderPage(data) {\n        laypage.render({\n            elem: $('.layui-layer-content').find('.select-modal-page')[0],\n            limit: data.pageSize,\n            count: data.count,\n            curr: data.page,\n            layout: ['prev', 'page', 'next'],\n            jump: function jump(obj, first) {\n                var search = $('.modal-search-input').val().trim();\n                if (!first) {\n                    getData({\n                        page: obj.curr,\n                        pageSize: data.pageSize,\n                        \"name\": search || \"\"\n                    }, function (data) {\n                        renderTable(data);\n                    });\n                }\n            }\n        });\n    };\n    exports(\"selectCustomer\", {\n        start: function start(callback) {\n            layer.open({\n                title: '选择客户',\n                type: 0,\n                area: ['640px', '540px'],\n                content: '<div class=\"select-modal-container\"> ' + '<div class=\"select-modal-box\"> ' + '<div class=\"select-search-container\">' + '<input class=\"layui-input modal-search-input\" type=\"text\" placeholder=\"输入客户信息检索\">' + '<div class=\"layui-btn-group\" style=\"margin-top:-4px\"> ' + '<button class=\"layui-btn modal-search-btn\">搜索</button> ' + '<button class=\"layui-btn layui-btn-primary modal-clear-btn\">清空</button> ' + '</div>' + '</div>' + '<table lay-filter=\"select-modal-table\" class=\"select-modal-table\"></table> ' + '<div class=\"select-modal-page\"></div> ' + '</div> ' + '</div>',\n                success: function success() {\n                    $('.modal-search-btn').click(function () {\n                        var query = {};\n                        var search = $('.modal-search-input').val().trim();\n                        if (search) {\n                            query['name'] = search;\n                        }\n                        getData(query, function (data) {\n                            renderTable(data);\n                            renderPage(data);\n                        });\n                    });\n                    $('.modal-clear-btn').on('click', function () {\n                        $('.modal-search-input').val('');\n                        getData({}, function (data) {\n                            renderTable(data);\n                            renderPage(data);\n                        });\n                    });\n                    getData({}, function (data) {\n                        renderTable(data);\n                        renderPage(data);\n                    });\n                },\n                yes: function yes(index, layero) {\n                    var $checked = $('.layui-layer-content .select-modal-checkbox:checked');\n                    if ($checked.length) {\n                        var eq = $checked.parent().parent().parent().index();\n                        var data = active_data.list[eq];\n                        callback(data);\n                        layer.close(index);\n                    } else {\n                        layer.tips('请勾选需要操作的数据', '.layui-layer-btn0');\n                    }\n                }\n            });\n        },\n        initInput: function initInput(selector, callback, need) {\n            var _this = this;\n            selector = selector ? selector : '.jl-select-customer';\n            need = need ? need : 'user_name';\n            $(selector).click(function () {\n                var $this = $(this);\n                _this.start(function (data) {\n                    $this.val(data[need]);\n                    $this.data('id', data.id);\n                    if ($this.siblings(\"input\")) $this.siblings(\"input\").val(data.id);\n                    if (callback) {\n                        callback(data);\n                    }\n                });\n            });\n        }\n    });\n});"]}