{"version":3,"sources":["Admin/Public/js/select-erp-product.js"],"names":["layui","define","exports","active_data","layer","table","form","laypage","edites","getData","query","callback","$","get","res","parseJSON","error","data","console","log","tips","msg","renderTable","render","elem","list","page","limit","pageSize","cellMinWidth","height","cols","field","width","fixed","templet","title","on","$checkboxs","prop","renderPage","find","count","curr","layout","jump","obj","first","start","open","type","area","content","success","click","search","val","trim","yes","index","layero","$checked","length","each","indexNum","this","parent","push","close","initInput","selectors","addRow","edite","_this","$this","key","value"],"mappings":"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","file":"../../../../../temporaryJs/Admin/Public/js/select-erp-product.js","sourcesContent":["'use strict';\n\nlayui.define(['layer', 'table', 'form', 'laypage'], function (exports) {\n    var layer = layui.layer;\n    var table = layui.table;\n    var form = layui.form;\n    var laypage = layui.laypage;\n    // var actionTable = layui.actionTable;\n    //\n    var active_data;\n    var edites = \"\";\n    var getData = function getData(query, callback) {\n        $.get('/Admin/ErpProduct/erpProductList', query, function (res) {\n            res = $.parseJSON(res);\n            if (res.error === 0) {\n                active_data = res.data;\n                console.log(res.data);\n                callback(res.data);\n            } else {\n                layer.tips(res.msg, '.modal-search-btn');\n            }\n        });\n    };\n    var renderTable = function renderTable(data) {\n        table.render({\n            elem: '.select-modal-table',\n            data: data.list,\n            page: false,\n            limit: data.pageSize,\n            cellMinWidth: 160,\n            height: '320',\n            cols: [[{ field: 'checkbox', width: 50, fixed: 'left', templet: '<div><input class=\"select-modal-checkbox\" lay-filter=\"c_check\" type=\"checkbox\" name=\"\" lay-skin=\"primary\"></div>' }, { field: 'fitemno', title: 'erp型号', width: 220 }, { field: 'fstcb', title: '标准成本', width: 160 }, { field: 'store', title: '库存', width: 100 }, { field: 'last_time', title: '更新时间', width: 160 }, { field: 'create_time', title: '创建时间', width: 160 }]]\n        });\n        form.on('checkbox(c_check)', function (data) {\n            var $checkboxs = $('.select-modal-checkbox');\n            //$checkboxs.prop('checked',false);\n            //console.log(\"321\",edites);\n            if (edites == \"edit\") {\n                $checkboxs.prop('checked', false);\n                $(data.elem).prop('checked', true);\n            } else {\n                if (!$(data.elem).prop('checked')) {\n                    $(data.elem).prop('checked', false);\n                } else {\n                    $(data.elem).prop('checked', true);\n                }\n            }\n            form.render('checkbox');\n        });\n    };\n    var renderPage = function renderPage(data) {\n        laypage.render({\n            elem: $('.layui-layer-content').find('.select-modal-page')[0],\n            limit: data.pageSize,\n            count: data.count,\n            curr: data.page,\n            layout: ['prev', 'page', 'next'],\n            jump: function jump(obj, first) {\n                if (!first) {\n                    getData({\n                        page: obj.curr,\n                        pageSize: data.pageSize\n                    }, function (data) {\n                        renderTable(data);\n                    });\n                }\n            }\n        });\n    };\n    exports(\"selectErpProduct\", {\n        start: function start(callback) {\n            layer.open({\n                title: '选择erp商品',\n                type: 0,\n                area: ['640px', '70%'],\n                content: '<div class=\"select-modal-container\"> ' + '<div class=\"select-modal-box\"> ' + '<div class=\"select-search-container\">' + '<input class=\"layui-input modal-search-input\" type=\"text\" placeholder=\"输入ERP型号检索\">' + '<div class=\"layui-btn-group\"> ' + '<button class=\"layui-btn modal-search-btn\">搜索</button> ' + '<button class=\"layui-btn layui-btn-primary modal-clear-btn\">清空</button> ' + '</div>' + '</div>' + '<table lay-filter=\"select-modal-table\" class=\"select-modal-table\"></table> ' + '<div class=\"select-modal-page\"></div> ' + '</div> ' + '</div>',\n                success: function success() {\n                    $('.modal-search-btn').click(function () {\n                        var query = {};\n                        var search = $('.modal-search-input').val().trim();\n                        if (search) {\n                            query['fitemno'] = search;\n                        }\n                        getData(query, function (data) {\n                            renderTable(data);\n                            renderPage(data);\n                        });\n                    });\n                    getData({}, function (data) {\n                        renderTable(data);\n                        renderPage(data);\n                    });\n                },\n                yes: function yes(index, layero) {\n                    var $checked = $('.layui-layer-content .select-modal-checkbox:checked');\n                    if ($checked.length) {\n                        var data = [];\n                        $checked.each(function () {\n                            var indexNum = 0;\n                            indexNum = $(this).parent().parent().parent().index();\n                            data.push(active_data.list[indexNum]);\n                        });\n                        // var eq = $checked.parent().parent().parent().index();\n                        // var data = active_data.list[eq];\n                        //console.log(data);\n                        callback(data);\n                        layer.close(index);\n                    } else {\n                        layer.tips('请勾选需要操作的数据', '.layui-layer-btn0');\n                    }\n                }\n            });\n        },\n        initInput: function initInput(selectors, callback, addRow, edite) {\n            this.addRow = addRow;\n            var _this = this;\n            edites = edite;\n            var selector = selectors ? selectors : '.jl-select-erp-product';\n            $(selector).click(function () {\n                var $this = $(this);\n                _this.start(function (data) {\n                    console.log(data);\n                    $.each(data, function (key, value) {\n                        /* $this.val(value.fitemno);\r\n                         $this.data('id',value.id);*/\n                        if (addRow) addRow(value, $this, key);\n                    });\n\n                    if (callback) {\n                        callback(data, $this);\n                    }\n                });\n            });\n        }\n    });\n});"]}