{"version":3,"sources":["Common/module/uba/1.0/uba.js"],"names":["_uba","encodeWrapper","window","encodeURIComponent","decodeWrapper","decodeURIComponent","_amp_","_equal_","configCookieNamePrefix","params","clientArgs","timeTrack","param_utma","param_utmu","param_utmi","visitCookieValue","configVisitorCookieTimeout","configCookiePath","configCookieDomain","configCookieIsSecure","locationArray","urlFixup","document","domain","location","href","getReferrer","clientOs","isDefined","property","isFunction","isObject","isString","String","isObjectEmpty","i","isEmpty","Object","prototype","hasOwnProperty","call","checkIsFisrtVisited","hasCookie","getCookieName","baseName","getCookie","cookieName","navigator","cookieEnabled","name","ca","cookie","split","length","c","charAt","substring","indexOf","setCookie","value","msToExpire","path","isSecure","expiryDate","Date","setTime","getTime","toGMTString","deleteCookie","getServerSessionValue","getCurrentTimestampInSeconds","Math","floor","createUtmaUUID","sha1","userAgent","platform","random","slice","createFirstVisitValue","nowTs","uuid","firstVisitTs","lastVisitTs","currentVisitTs","visitCount","setVisitorUuid","getRemainingVisitorCookieTimeout","setVisitorUtmaToCookie","visitorIdCookieValues","getVisitCookieValue","cookieValue","setSessionToLocal","localStorage","setItem","setVisitorUtmuToCookie","visitCookieValues","arr","cookieCreatedTs","parseInt","updateVisitorUtma","now","referrer","top","e","parent","e2","getHostName","url","matches","RegExp","exec","getUrlParameter","results","hostName","links","utf8_encode","argString","unescape","str","blockstart","j","A","B","C","D","E","temp","str_len","rotate_left","n","s","cvt_hex","val","strout","toString","W","H0","H1","H2","H3","H4","word_array","charCodeAt","push","toLowerCase","getRequest","search","theRequest","substr","strs","connectParams","args","Array","remove","dx","isNaN","this","timeTracker","timing","performance","t","loadTime","loadEventEnd","navigationStart","setTimeout","readyStart","fetchStart","redirectTime","redirectEnd","redirectStart","appcacheTime","domainLookupStart","unloadEventTime","unloadEventEnd","unloadEventStart","lookupDomainTime","domainLookupEnd","connectTime","connectEnd","connectStart","requestTime","responseEnd","requestStart","initDomTreeTime","domInteractive","domReadyTime","domComplete","loadEventTime","loadEventStart","JSON","stringify","client","engine","ie","gecko","webkit","khtml","opera","ver","browser","firefox","safari","konq","chrome","system","win","mac","xll","iphone","ipoad","ipad","ios","android","nokiaN","winMobile","wii","ps","ua","version","parseFloat","test","safariVersion","p","ipod","replace","getClientOs","bn","bnv","engn","engv","osn","osv","setCustomParams","assign","setWebSite","siteId","sid","setModelName","modn","setActionName","actn","setParamsValue","parv","addTraceEvent","data","ts","traceEventList","parse","getItem","sendImg","cid","screen","sh","height","sw","width","cd","colorDepth","la","language","apn","appName","apv","appVersion","apc","appCodeName","cArgs","Image","src","timeTrace","vc","timeArgs","sendUnloadImg","func","eval","unloadParam","stayTs","tev","removeItem","addEventListener","console","log","title"],"mappings":"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","file":"../../../../../../temporaryJs/Common/module/uba/1.0/uba.js","sourcesContent":["(function () {\r\n    if (typeof _uba !== 'object') {\r\n        _uba = [];\r\n    }\r\n\r\n    var /* encode */\r\n        encodeWrapper = window.encodeURIComponent,\r\n        /* decode */\r\n        decodeWrapper = window.decodeURIComponent,\r\n        _amp_ = \"&\",\r\n        _equal_ = \"=\",\r\n        configCookieNamePrefix = '_uba_',\r\n        //访问链接主体参数\r\n        params = {},\r\n        //客户端信息参数\r\n        clientArgs = {},\r\n        //性能监测参数\r\n        timeTrack = {},\r\n        /**\r\n         * utma的主要功能：识别唯一身份访客\r\n         * 其中第一组的随机唯一ID和第二组的时间戳联合组成了访问者ID，通过这个ID来辨别网站的唯一访问者。\r\n         * 而后面的几个时间戳用户计算网站停留时间和访问次数。\r\n         * utma Cookie存储的内容：1360367272.1264374807.1264374807.1264374807.1\r\n         * 第一组数字是一个随机产生的唯一ID。\r\n         * 第二，三，四组数字是时间戳，其中第二组数字表示初次访问的时间。第三组数字表示上一次访问的时间，第四组数字表示本次访问开始的时间。\r\n         * 第五组数字是访问次数计数器。这个数字随着访问次数的增加而增加。\r\n         * PS：上面的三个时间戳数字相同，并且最后的访问次数计数器是1，表示这是第一次访问。\r\n         */\r\n        param_utma = 'utma',\r\n        /*\r\n         * 标识访问网址 生存周期到网页关闭\r\n         */\r\n        param_utmu = 'utmu',\r\n        /*\r\n         * 存储用户标识 只在第一次访问生存 与 utma一样\r\n         */\r\n        param_utmi = 'utmi',\r\n        visitCookieValue = {},\r\n        configVisitorCookieTimeout = 33955200000, // 13 months (365 days + 28days)\r\n        configCookiePath = '/',\r\n        configCookieDomain,\r\n        configCookieIsSecure,\r\n        // 当前页网址和来源页网址\r\n        locationArray = urlFixup(document.domain, window.location.href, getReferrer()),\r\n        //页面性能耗时监测\r\n        clientOs = {};\r\n\r\n    //判断变量是否存在\r\n    function isDefined(property) {\r\n        var propertyType = typeof property;\r\n\r\n        return propertyType !== 'undefined';\r\n    }\r\n\r\n    function isFunction(property) {\r\n        return typeof property === 'function';\r\n    }\r\n\r\n    function isObject(property) {\r\n        return typeof property === 'object';\r\n    }\r\n\r\n    function isString(property) {\r\n        return typeof property === 'string' || property instanceof String;\r\n    }\r\n\r\n    function isObjectEmpty(property) {\r\n        if (!property) {\r\n            return true;\r\n        }\r\n\r\n        var i;\r\n        var isEmpty = true;\r\n        for (i in property) {\r\n            if (Object.prototype.hasOwnProperty.call(property, i)) {\r\n                isEmpty = false;\r\n            }\r\n        }\r\n\r\n        return isEmpty;\r\n    }\r\n\r\n    //检查是否第一次访问;\r\n    function checkIsFisrtVisited() {\r\n        return hasCookie(getCookieName(param_utmi)) ? false : true;\r\n    }\r\n\r\n    //生成cookie名称\r\n    function getCookieName(baseName) {\r\n        return configCookieNamePrefix + baseName;\r\n    }\r\n\r\n    /*\r\n     * 获取cookie 值\r\n     */\r\n    function getCookie(cookieName) {\r\n\r\n        if (!navigator.cookieEnabled) {\r\n            return 0;\r\n        }\r\n\r\n        var name = cookieName + \"=\";\r\n        var ca = document.cookie.split(';');\r\n        for (var i = 0; i < ca.length; i++) {\r\n            var c = ca[i];\r\n            while (c.charAt(0) == ' ') c = c.substring(1);\r\n            if (c.indexOf(name) != -1) return c.substring(name.length, c.length);\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /*\r\n     * 设置Cookie\r\n     */\r\n    function setCookie(cookieName, value, msToExpire, path, domain, isSecure) {\r\n        if (!navigator.cookieEnabled) {\r\n            return 0;\r\n        }\r\n        var expiryDate;\r\n\r\n        // relative time to expire in milliseconds\r\n        if (msToExpire) {\r\n            expiryDate = new Date();\r\n            expiryDate.setTime(expiryDate.getTime() + msToExpire);\r\n        }\r\n\r\n        document.cookie = cookieName + '=' + encodeWrapper(value) +\r\n            (msToExpire ? ';expires=' + expiryDate.toGMTString() : '') +\r\n            ';path=' + (path || '/') +\r\n            (domain ? ';domain=' + domain : '') +\r\n            (isSecure ? ';secure' : '');\r\n    }\r\n\r\n    /*\r\n     * 检查某Cookie是否存在\r\n     */\r\n    function hasCookie(cookieName) {\r\n        if (!navigator.cookieEnabled) {\r\n            return 0;\r\n        }\r\n        var s = document.cookie.indexOf(cookieName + '=');\r\n        return s == -1 ? false : true;\r\n    }\r\n\r\n    /*\r\n     * 删除cookie\r\n     */\r\n    function deleteCookie(cookieName, path, domain) {\r\n        setCookie(cookieName, '', -86400, path, domain);\r\n    }\r\n\r\n    function getServerSessionValue() {\r\n        return getCookie('PHPSESSID');\r\n    }\r\n\r\n    /*\r\n     * 获取当前时间戳\r\n    */\r\n    function getCurrentTimestampInSeconds() {\r\n        return Math.floor((new Date()).getTime() / 1000);\r\n    }\r\n\r\n    /*\r\n     * 生成唯一标识id\r\n     */\r\n    function createUtmaUUID() {\r\n        return sha1(\r\n            (getServerSessionValue()) +\r\n            (navigator.userAgent || '') +\r\n            (navigator.platform || '') +\r\n            (new Date()).getTime() +\r\n            Math.random()\r\n        ).slice(0, 16);\r\n    }\r\n\r\n    /*\r\n     * 生成第一次访问的UTMA值\r\n     */\r\n    function createFirstVisitValue() {\r\n        var nowTs = getCurrentTimestampInSeconds();\r\n        visitCookieValue.uuid = createUtmaUUID();\r\n        visitCookieValue.firstVisitTs = nowTs;\r\n        visitCookieValue.lastVisitTs = nowTs;\r\n        visitCookieValue.currentVisitTs = nowTs;\r\n        visitCookieValue.visitCount = 1;\r\n        return visitCookieValue;\r\n    }\r\n\r\n    function setVisitorUuid(uuid) {\r\n        setCookie(getCookieName(param_utmi), uuid, getRemainingVisitorCookieTimeout(), configCookiePath, configCookieDomain, configCookieIsSecure);\r\n    }\r\n\r\n    /*\r\n     * 设置访问者的utma到cookie\r\n     */\r\n    function setVisitorUtmaToCookie(visitorIdCookieValues) {\r\n        if (!visitorIdCookieValues) {\r\n            visitorIdCookieValues = getVisitCookieValue();\r\n        }\r\n        var cookieValue = visitorIdCookieValues.uuid + '.' +\r\n            visitorIdCookieValues.firstVisitTs + '.' +\r\n            visitorIdCookieValues.lastVisitTs + '.' +\r\n            visitorIdCookieValues.currentVisitTs + '.' +\r\n            visitorIdCookieValues.visitCount;\r\n        setCookie(getCookieName(param_utma), cookieValue, getRemainingVisitorCookieTimeout(), configCookiePath, configCookieDomain, configCookieIsSecure);\r\n        setVisitorUuid(visitorIdCookieValues.uuid);\r\n    }\r\n\r\n    function setSessionToLocal() {\r\n        localStorage.setItem('session', getServerSessionValue())\r\n    }\r\n\r\n    function setVisitorUtmuToCookie() {\r\n        setCookie(getCookieName(param_utmu), locationArray[1], getRemainingVisitorCookieTimeout(), configCookiePath, configCookieDomain, configCookieIsSecure);\r\n}\r\n\r\n    function getVisitCookieValue() {\r\n        var visitCookieValues = getCookie(getCookieName(param_utma));\r\n        if (!isDefined(visitCookieValues)) {\r\n            visitCookieValue = createFirstVisitValue();\r\n        } else {\r\n            var arr = visitCookieValues.split('.');\r\n            visitCookieValue.uuid = arr[0];\r\n            visitCookieValue.firstVisitTs = arr[1];\r\n            visitCookieValue.lastVisitTs = arr[2];\r\n            visitCookieValue.currentVisitTs = arr[3];\r\n            visitCookieValue.visitCount = arr[4];\r\n        }\r\n        return visitCookieValue;\r\n    }\r\n\r\n    function getRemainingVisitorCookieTimeout() {\r\n        var now = new Date(),\r\n            nowTs = now.getTime(),\r\n            cookieCreatedTs = visitCookieValue.firstVisitTs;\r\n        return (parseInt(cookieCreatedTs, 10) * 1000) + configVisitorCookieTimeout - nowTs;\r\n    }\r\n\r\n    function updateVisitorUtma() {\r\n        var cookieValue = getVisitCookieValue();\r\n        var now = getCurrentTimestampInSeconds();\r\n        cookieValue.lastVisitTs = cookieValue.currentVisitTs;\r\n        cookieValue.currentVisitTs = now;\r\n        cookieValue.visitCount = parseInt(cookieValue.visitCount) + 1;\r\n        visitCookieValue = cookieValue;\r\n        setVisitorUtmaToCookie(cookieValue);\r\n    }\r\n\r\n    /*\r\n     * 获取访问页面来源链接\r\n     */\r\n    function getReferrer() {\r\n        var referrer = '';\r\n\r\n        try {\r\n            referrer = window.top.document.referrer;\r\n        } catch (e) {\r\n            if (window.parent) {\r\n                try {\r\n                    referrer = window.parent.document.referrer;\r\n                } catch (e2) {\r\n                    referrer = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        if (referrer === '') {\r\n            referrer = document.referrer;\r\n        }\r\n\r\n        return referrer;\r\n    }\r\n\r\n    function getHostName(url) {\r\n        // scheme : // [username [: password] @] hostame [: port] [/ [path] [? query] [# fragment]]\r\n        var e = new RegExp('^(?:(?:https?|ftp):)/*(?:[^@]+@)?([^:/#]+)'),\r\n            matches = e.exec(url);\r\n\r\n        return matches ? matches[1] : url;\r\n    }\r\n\r\n    function getUrlParameter(url, name) {\r\n        var regexSearch = \"[\\\\?&#]\" + name + \"=([^&#]*)\";\r\n        var regex = new RegExp(regexSearch);\r\n        var results = regex.exec(url);\r\n        return results ? decodeWrapper(results[1]) : '';\r\n    }\r\n\r\n    function urlFixup(hostName, href, referrer) {\r\n        if (!hostName) {\r\n            hostName = '';\r\n        }\r\n\r\n        if (!href) {\r\n            href = '';\r\n        }\r\n\r\n        if (hostName === 'translate.googleusercontent.com') {       // Google\r\n            if (referrer === '') {\r\n                referrer = href;\r\n            }\r\n\r\n            href = getUrlParameter(href, 'u');\r\n            hostName = getHostName(href);\r\n        } else if (hostName === 'cc.bingj.com' ||                  // Bing\r\n            hostName === 'webcache.googleusercontent.com' ||    // Google\r\n            hostName.slice(0, 5) === '74.6.') {                 // Yahoo (via Inktomi 74.6.0.0/16)\r\n            href = document.links[0].href;\r\n            hostName = getHostName(href);\r\n        }\r\n\r\n        return [hostName, href, referrer];\r\n    }\r\n\r\n    /*\r\n     * UTF-8 encoding\r\n     */\r\n    function utf8_encode(argString) {\r\n        return unescape(window.encodeURIComponent(argString));\r\n    }\r\n\r\n    function sha1(str) {\r\n        var rotate_left = function (n, s) {\r\n                return (n << s) | (n >>> (32 - s));\r\n            },\r\n\r\n            cvt_hex = function (val) {\r\n                var strout = '',\r\n                    i,\r\n                    v;\r\n\r\n                for (i = 7; i >= 0; i--) {\r\n                    v = (val >>> (i * 4)) & 0x0f;\r\n                    strout += v.toString(16);\r\n                }\r\n\r\n                return strout;\r\n            },\r\n\r\n            blockstart,\r\n            i,\r\n            j,\r\n            W = [],\r\n            H0 = 0x67452301,\r\n            H1 = 0xEFCDAB89,\r\n            H2 = 0x98BADCFE,\r\n            H3 = 0x10325476,\r\n            H4 = 0xC3D2E1F0,\r\n            A,\r\n            B,\r\n            C,\r\n            D,\r\n            E,\r\n            temp,\r\n            str_len,\r\n            word_array = [];\r\n\r\n        str = utf8_encode(str);\r\n        str_len = str.length;\r\n\r\n        for (i = 0; i < str_len - 3; i += 4) {\r\n            j = str.charCodeAt(i) << 24 | str.charCodeAt(i + 1) << 16 |\r\n                str.charCodeAt(i + 2) << 8 | str.charCodeAt(i + 3);\r\n            word_array.push(j);\r\n        }\r\n\r\n        switch (str_len & 3) {\r\n            case 0:\r\n                i = 0x080000000;\r\n                break;\r\n            case 1:\r\n                i = str.charCodeAt(str_len - 1) << 24 | 0x0800000;\r\n                break;\r\n            case 2:\r\n                i = str.charCodeAt(str_len - 2) << 24 | str.charCodeAt(str_len - 1) << 16 | 0x08000;\r\n                break;\r\n            case 3:\r\n                i = str.charCodeAt(str_len - 3) << 24 | str.charCodeAt(str_len - 2) << 16 | str.charCodeAt(str_len - 1) << 8 | 0x80;\r\n                break;\r\n        }\r\n\r\n        word_array.push(i);\r\n\r\n        while ((word_array.length & 15) !== 14) {\r\n            word_array.push(0);\r\n        }\r\n\r\n        word_array.push(str_len >>> 29);\r\n        word_array.push((str_len << 3) & 0x0ffffffff);\r\n\r\n        for (blockstart = 0; blockstart < word_array.length; blockstart += 16) {\r\n            for (i = 0; i < 16; i++) {\r\n                W[i] = word_array[blockstart + i];\r\n            }\r\n\r\n            for (i = 16; i <= 79; i++) {\r\n                W[i] = rotate_left(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1);\r\n            }\r\n\r\n            A = H0;\r\n            B = H1;\r\n            C = H2;\r\n            D = H3;\r\n            E = H4;\r\n\r\n            for (i = 0; i <= 19; i++) {\r\n                temp = (rotate_left(A, 5) + ((B & C) | (~B & D)) + E + W[i] + 0x5A827999) & 0x0ffffffff;\r\n                E = D;\r\n                D = C;\r\n                C = rotate_left(B, 30);\r\n                B = A;\r\n                A = temp;\r\n            }\r\n\r\n            for (i = 20; i <= 39; i++) {\r\n                temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & 0x0ffffffff;\r\n                E = D;\r\n                D = C;\r\n                C = rotate_left(B, 30);\r\n                B = A;\r\n                A = temp;\r\n            }\r\n\r\n            for (i = 40; i <= 59; i++) {\r\n                temp = (rotate_left(A, 5) + ((B & C) | (B & D) | (C & D)) + E + W[i] + 0x8F1BBCDC) & 0x0ffffffff;\r\n                E = D;\r\n                D = C;\r\n                C = rotate_left(B, 30);\r\n                B = A;\r\n                A = temp;\r\n            }\r\n\r\n            for (i = 60; i <= 79; i++) {\r\n                temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & 0x0ffffffff;\r\n                E = D;\r\n                D = C;\r\n                C = rotate_left(B, 30);\r\n                B = A;\r\n                A = temp;\r\n            }\r\n\r\n            H0 = (H0 + A) & 0x0ffffffff;\r\n            H1 = (H1 + B) & 0x0ffffffff;\r\n            H2 = (H2 + C) & 0x0ffffffff;\r\n            H3 = (H3 + D) & 0x0ffffffff;\r\n            H4 = (H4 + E) & 0x0ffffffff;\r\n        }\r\n\r\n        temp = cvt_hex(H0) + cvt_hex(H1) + cvt_hex(H2) + cvt_hex(H3) + cvt_hex(H4);\r\n\r\n        return temp.toLowerCase();\r\n    }\r\n\r\n    /*\r\n　 *　方法:Array.remove(dx)\r\n　 *　功能:删除数组元素.\r\n　 *　参数:dx删除元素的下标.\r\n　 *　返回:在原数组上修改数组\r\n*/\r\n    //经常用的是通过遍历,重构数组.\r\n    Array.prototype.remove=function(dx) {\r\n        if(isNaN(dx)||dx>this.length){return false;}\r\n        for(var i=0,n=0;i<this.length;i++)\r\n        {\r\n            if(this[i]!=this[dx])\r\n            {\r\n                this[n++]=this[i]\r\n            }\r\n        }\r\n        this.length-=1\r\n    }\r\n\r\n    function getRequest() {\r\n        var url = location.search; //获取url中\"?\"符后的字串\r\n        var theRequest = new Object();\r\n        if (url.indexOf(\"?\") != -1) {\r\n            var str = url.substr(1);\r\n            strs = str.split(\"&\");\r\n            for(var i = 0; i < strs.length; i ++) {\r\n                theRequest[strs[i].split(\"=\")[0]]=unescape(strs[i].split(\"=\")[1]);\r\n            }\r\n        }\r\n        return theRequest;\r\n    }\r\n\r\n    //拼接参数\r\n    function connectParams(params) {\r\n        if (params == null) {\r\n            return params;\r\n        }\r\n        var args = '';\r\n        for (var i in params) {\r\n            if (args !== '') {\r\n                args += _amp_;\r\n            }\r\n            args += i + _equal_ + encodeURIComponent(params[i]);\r\n        }\r\n        return args;\r\n    }\r\n\r\n    var timeTracker = function () {\r\n        var timing = window.performance.timing;\r\n        var t = {};\r\n        t.uuid = visitCookieValue.uuid;\r\n        t.url = locationArray[1];\r\n        //从开始至load总耗时\r\n        t.loadTime = timing.loadEventEnd - timing.navigationStart;//过早获取时,loadEventEnd有时会是0\r\n        if (t.loadTime <= 0) {\r\n            // 未加载完，延迟200ms后重复监测，直到成功\r\n            setTimeout(function () {\r\n                timeTracker();\r\n            }, 200);\r\n            return;\r\n        }\r\n        //准备新页面时间耗时\r\n        t.readyStart = timing.fetchStart - timing.navigationStart;\r\n        //redirect 重定向耗时\r\n        t.redirectTime = timing.redirectEnd - timing.redirectStart;\r\n        //Appcache 耗时\r\n        t.appcacheTime = timing.domainLookupStart - timing.fetchStart;\r\n        //unload 前文档耗时\r\n        t.unloadEventTime = timing.unloadEventEnd - timing.unloadEventStart;\r\n        //DNS 查询耗时\r\n        t.lookupDomainTime = timing.domainLookupEnd - timing.domainLookupStart;\r\n        //TCP连接耗时\r\n        t.connectTime = timing.connectEnd - timing.connectStart;\r\n        //request请求耗时\r\n        t.requestTime = timing.responseEnd - timing.requestStart;\r\n        //请求完毕至DOM加载\r\n        t.initDomTreeTime = timing.domInteractive - timing.responseEnd;\r\n        //解析dom树耗时\r\n        t.domReadyTime = timing.domComplete - timing.domInteractive; //过早获取时,domComplete有时会是0\r\n        //load事件耗时\r\n        t.loadEventTime = timing.loadEventEnd - timing.loadEventStart;\r\n        localStorage.setItem('timeTrace', JSON.stringify(t));\r\n    };\r\n    var client = function () {\r\n        //内核引擎\r\n        var engine = {\r\n            ie: 0,\r\n            gecko: 0,\r\n            webkit: 0,\r\n            khtml: 0,\r\n            opera: 0,\r\n            ver: null\r\n        };\r\n        //浏览器\r\n        var browser = {\r\n            ie: 0,\r\n            firefox: 0,\r\n            safari: 0,\r\n            konq: 0,\r\n            opera: 0,\r\n            chrome: 0,\r\n            ver: null\r\n        };\r\n\r\n        //操作系统\r\n        var system = {\r\n            win: false,\r\n            mac: false,\r\n            xll: false,\r\n            iphone: false,\r\n            ipoad: false,\r\n            ipad: false,\r\n            ios: false,\r\n            android: false,\r\n            nokiaN: false,\r\n            winMobile: false,\r\n            wii: false,\r\n            ps: false\r\n        };\r\n\r\n        var ua = navigator.userAgent;\r\n        // 检测浏览器呈现引擎\r\n        if (window.opera) {\r\n            engine.ver = browser.ver = window.opera.version();\r\n            engine.opera = browser.opera = parseFloat(engine.ver);\r\n        } else if (/AppleWebkit\\/(\\S+)/i.test(ua)) {\r\n            engine.ver = RegExp['$1'];\r\n            engine.webkit = parseFloat(engine.ver);\r\n\r\n            // 确定是Chrome还是Safari\r\n            if (/Chrome\\/(\\S+)/i.test(ua)) {\r\n                browser.ver = RegExp['$1'];\r\n                browser.chrome = parseFloat(browser.ver);\r\n            } else if (/Version\\/(\\S+)/i.test(ua)) {\r\n                browser.ver = RegExp['$1'];\r\n                browser.safari = parseFloat(browser.ver);\r\n            } else {\r\n                // 近似地确定版本号\r\n                var safariVersion = 1;\r\n                if (engine.webkit < 100) {\r\n                    safariVersion = 1;\r\n                } else if (engine.webkit < 312) {\r\n                    safariVersion = 1.2;\r\n                } else if (engine.webkit < 412) {\r\n                    safariVersion = 1.3;\r\n                } else {\r\n                    safariVersion = 2;\r\n                }\r\n\r\n                browser.safari = browser.safari = safariVersion;\r\n            }\r\n        } else if (/KHTML\\/(\\S+)/i.test(ua) || /Konqueror\\/([^;]+)/i.test(ua)) {\r\n            engine.ver = browser.ver = RegExp['$1'];\r\n            engine.khtml = browser.konq = parseFloat(engine.ver);\r\n        } else if (/rv:([^\\)]+)\\) Gecko\\/\\d{8}/i.test(ua)) {\r\n            engine.ver = RegExp['$1'];\r\n            engine.gecko = parseFloat(engine.ver);\r\n            // 确定是不是Firefox\r\n            if (/Firefox\\/(\\S+)/i.test(ua)) {\r\n                engine.ver = browser.ver = RegExp['$1'];\r\n                engine.firefox = parseFloat(browser.ver);\r\n                browser.firefox = parseFloat(browser.ver);\r\n            }\r\n        } else if (/MSIE ([^;]+)/i.test(ua)) {\r\n            engine.ver = browser.ver = RegExp['$1'];\r\n            engine.ie = browser.ie = parseFloat(engine.ver);\r\n        }\r\n\r\n        // 检测平台\r\n        var p = navigator.platform;\r\n        system.win = p.indexOf('Win') == 0;\r\n        system.mac = p.indexOf('Mac') == 0;\r\n        system.xll = (p.indexOf('Xll') == 0 || p.indexOf('Linux') == 0);\r\n\r\n        // 检测Windows操作系统\r\n        if (system.win) {\r\n            if (/Win(?:dows )?([^do]{2})\\s?(\\d+\\.\\d+)?/.test(ua)) {\r\n                if (RegExp['$1'] == 'NT') {\r\n                    switch (RegExp['$2']) {\r\n                        case '5.0':\r\n                            system.win = '2000';\r\n                            break;\r\n                        case '5.1':\r\n                            system.win = 'XP';\r\n                            break;\r\n                        case '6.0':\r\n                            system.win = 'Vista';\r\n                            break;\r\n                        case '6.1':\r\n                            system.win = '7';\r\n                            break;\r\n                        case '6.2':\r\n                            system.win = '8';\r\n                            break;\r\n                        default:\r\n                            system.win = 'NT';\r\n                            break;\r\n                    }\r\n                } else if (RegExp['$1'] == '9x') {\r\n                    system.win = 'ME';\r\n                } else {\r\n                    system.win = RegExp['$1'];\r\n                }\r\n            }\r\n        }\r\n\r\n        // 移动设备\r\n        system.iphone = ua.indexOf('iPhone') > -1;\r\n        system.ipod = ua.indexOf('iPod') > -1;\r\n        system.ipad = ua.indexOf('iPad') > -1;\r\n        system.nokiaN = ua.indexOf('nokiaN') > -1;\r\n\r\n        // windows mobile\r\n        if (system.win == 'CE') {\r\n            system.winMobile = system.win;\r\n        } else if (system.win == 'Ph') {\r\n            if (/Windows Phone OS (\\d+.\\d)/i.test(ua)) {\r\n                system.win = 'Phone';\r\n                system.winMobile = parseFloat(RegExp['$1']);\r\n            }\r\n        }\r\n\r\n        // 检测IOS版本\r\n        if (system.mac && ua.indexOf('Mobile') > -1) {\r\n            if (/CPU (?:iPhone )?OS (\\d+_\\d+)/i.test(ua)) {\r\n                system.ios = parseFloat(RegExp['$1'].replace('_', '.'));\r\n            } else {\r\n                system.ios = 2;        // 不能真正检测出来，所以只能猜测\r\n            }\r\n        }\r\n\r\n        // 检测Android版本\r\n        if (/Android (\\d+\\.\\d+)/i.test(ua)) {\r\n            system.android = parseFloat(RegExp['$1']);\r\n        }\r\n\r\n        // 游戏系统\r\n        system.wii = ua.indexOf('Wii') > -1;\r\n        system.ps = /PlayStation/i.test(ua);\r\n\r\n        return {\r\n            engine: engine,\r\n            browser: browser,\r\n            system: system\r\n        }\r\n    }();\r\n    var getClientOs = function () {\r\n        for (var i in client.browser) {\r\n            if (client.browser[i] !== 0 && i !== 'ver') {\r\n                clientOs.bn = i;\r\n                clientOs.bnv = client.browser.ver;\r\n            }\r\n        }\r\n        for (var i in client.engine) {\r\n            if (client.engine[i] !== 0 && i !== 'ver') {\r\n                clientOs.engn = i;\r\n                clientOs.engv = client.engine.ver;\r\n            }\r\n        }\r\n        for (var i in client.system) {\r\n            if (client.system[i] !== false && i !== 'ver') {\r\n                clientOs.osn = i;\r\n                clientOs.osv = client.system[i];\r\n            }\r\n        }\r\n    }();\r\n\r\n    function setCustomParams(args) {\r\n        if (isObject(args)) {\r\n            params = Object.assign(params, args);\r\n        }\r\n    }\r\n\r\n    function setWebSite(siteId){\r\n        params.sid = siteId;\r\n    }\r\n\r\n    function setModelName(name) {\r\n        params.modn = name;\r\n    }\r\n\r\n    function setActionName(name) {\r\n        params.actn = name;\r\n    }\r\n\r\n    //添加设置url参数\r\n    function setParamsValue(value) {\r\n        if( isObject(value)  ){\r\n            if( params.parv ){\r\n                params.parv = JSON.stringify(Object.assign( params.parv, value ));\r\n            }\r\n            params.parv = JSON.stringify(value);\r\n        }else if( params.parv && isString(value) ){\r\n            params.parv += value;\r\n        }else {\r\n            params.parv = value;\r\n        }\r\n    }\r\n\r\n    //添加页面操作事件追踪\r\n    function addTraceEvent( args ) {\r\n        if( !args.name || !args.data ){\r\n            return;\r\n        }\r\n        args.ts = getCurrentTimestampInSeconds();\r\n       var traceEventList = JSON.parse(localStorage.getItem('traceEventList')) || [] ;\r\n        traceEventList.push(args);\r\n        localStorage.setItem('traceEventList', JSON.stringify(traceEventList));\r\n    }\r\n\r\n    function sendImg() {\r\n        //拼接参数串\r\n        //客户端信息\r\n        //cid 客户端id\r\n        var cid = getCookie(getCookieName('ci'));\r\n        if (!isDefined(cid)) {\r\n\r\n            //Window对象数据\r\n            if (window && window.screen) {\r\n                clientArgs.sh = window.screen.height || 0;\r\n                clientArgs.sw = window.screen.width || 0;\r\n                clientArgs.cd = window.screen.colorDepth || 0;\r\n            }\r\n            //navigator对象数据\r\n            if (navigator) {\r\n                clientArgs.la = navigator.language || '';\r\n                clientArgs.apn = navigator.appName || '';\r\n                clientArgs.apv = navigator.appVersion || '';\r\n                clientArgs.apc = navigator.appCodeName || '';\r\n                clientArgs.ua = navigator.userAgent || '';\r\n                clientArgs.cookie = navigator.cookieEnabled ? 1 : 0;\r\n            }\r\n            clientArgs = Object.assign(clientArgs, clientOs);\r\n            clientArgs.uuid = params.uuid;\r\n            var cArgs = connectParams(clientArgs);\r\n            new Image(1, 1).src = '/Uba/Trace/clientTracker?' + cArgs;\r\n            cid = getCookie(getCookieName('ci'))\r\n        }\r\n        params.cid = cid || '';\r\n        //通过Image对象发送请求\r\n        //延迟500ms发送\r\n        setTimeout(function () {\r\n            //用户访问的主体信息\r\n            var args = connectParams(params);\r\n            new Image(1, 1).src = '/Uba/Trace/index?' + args;\r\n            //性能信息\r\n            var timeTrace = JSON.parse(localStorage.getItem('timeTrace'));\r\n            timeTrace.cid = cid;\r\n            timeTrace.vc = params.visitCount;\r\n            timeTrace.ts = params.currentVisitTs;\r\n            var timeArgs = connectParams(timeTrace);\r\n\r\n            (new Image(1, 1)).src = '/Uba/Trace/timeTracker?' + timeArgs;\r\n        }, 500)\r\n    }\r\n\r\n    function sendUnloadImg() {\r\n        if (_uba.length > 0) {\r\n            for (var i in _uba) {\r\n                try {\r\n                    var func = _uba[i][0];\r\n                    if (func && isFunction(eval(func)) && _uba[i][2] === 'unload' ) {\r\n                        eval(func + \"(\" + JSON.stringify(_uba[i][1]) + \")\");\r\n                    }\r\n                } catch (e) {\r\n                }\r\n            }\r\n        }\r\n        var unloadParam = {};\r\n        unloadParam.uuid = params.uuid;\r\n        unloadParam.vc = params.visitCount;\r\n        unloadParam.cid = params.cid || '';\r\n        unloadParam.firstVisitTs = params.firstVisitTs;\r\n        unloadParam.stayTs = getCurrentTimestampInSeconds() - params.currentVisitTs;\r\n        unloadParam.tev = localStorage.getItem('traceEventList');\r\n        var args = connectParams(unloadParam);\r\n        new Image(1, 1).src = '/Uba/Trace/beforeUnload?' + args;\r\n        localStorage.removeItem('traceEventList');\r\n    }\r\n\r\n    window.addEventListener(\"load\", function () {\r\n        timeTracker();\r\n\r\n        // 第一次访问\r\n        if (checkIsFisrtVisited() === 0) {\r\n            console.log('当前浏览器无法使用Cookie');\r\n        } else {\r\n            //检测 server是否有重新生成命令 设置重新生成vid\r\n            if( getCookie(getCookieName('create_id')) === '1' ){\r\n                setVisitorUtmaToCookie(createFirstVisitValue());\r\n                deleteCookie( getCookieName('create_id'));\r\n            }\r\n            //检查session 是否关闭过了浏览器\r\n            //存储的session 和 浏览器session不一样时 说明已经关闭过了浏览器\r\n            if (localStorage.getItem('session') !== getServerSessionValue()) {\r\n                setSessionToLocal();\r\n                setVisitorUtmaToCookie(createFirstVisitValue());\r\n            } else if (checkIsFisrtVisited()) {\r\n                setVisitorUtmaToCookie(getVisitCookieValue());\r\n            } else {\r\n                if (!hasCookie(getCookieName(param_utma))) {\r\n                    setVisitorUtmaToCookie(getVisitCookieValue());\r\n                }\r\n                updateVisitorUtma();\r\n            }\r\n            // if (!hasCookie(getCookieName(param_utmu))) {\r\n            //     setVisitorUtmuToCookie();\r\n            // }\r\n            params = Object.assign(params, visitCookieValue);\r\n            if (_uba) {\r\n                if (_uba.length > 0) {\r\n                    for (var i in _uba) {\r\n                        try {\r\n                            var func = _uba[i][0];\r\n                            if (func && isFunction(eval(func))) {\r\n                                eval(func + \"(\" + JSON.stringify(_uba[i][1]) + \")\");\r\n                                // _uba.remove(i);\r\n                            }\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n                }\r\n                //Document对象数据\r\n                if (document) {\r\n                    params.domain = locationArray[0];\r\n                    params.url = locationArray[1];\r\n                    params.title = document.title || '';\r\n                    params.referrer = locationArray[2];\r\n                }\r\n\r\n                if( getRequest() ){\r\n                    setParamsValue( getRequest()  );\r\n                }\r\n                sendImg();\r\n            }\r\n        }\r\n    });\r\n    //关闭和刷新时\r\n    window.addEventListener(\"beforeunload\", function (e) {\r\n        sendUnloadImg();\r\n    });\r\n    //超时3分钟未操作页面重新生成访问标识\r\n    window.setTimeout( function(){\r\n        setVisitorUtmaToCookie(createFirstVisitValue());\r\n    },180*1000 );\r\n\r\n})();"]}