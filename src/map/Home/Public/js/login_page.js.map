{"version":3,"sources":["Home/Public/js/login_page.js"],"names":["require","$","modal","links","document","createElement","id","setAttribute","href","append","cookData","cookie","split","dataObj","each","ind","val","arrays","trim","user","login_page","login_init","isPoint","$user_input","$password_input","$user_adm","$password_paw","blur","css","children","html","on","e","keyCode","trigger","index","layer","load","password","data","user_name","user_pass","isremenber","find","post","res","status","login_fn","name_show","remove","closeAll","msg","icon","times","Date","setTime","getTime","str","toGMTString","close","content","user_id","this","attr","location","login_html","window"],"mappings":"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","file":"../../../../../temporaryJs/Home/Public/js/login_page.js","sourcesContent":["'use strict';\n\nrequire(['jquery', 'jl-modal'], function ($, modal) {\n    require(['Account/js/common_register']);\n    //动态添加css\n    var links = document.createElement(\"link\");\n    links.id = \"login_id\";\n    links.setAttribute(\"rel\", \"stylesheet\");\n    links.href = \"/Public/Home/Index/css/login-message.css\";\n    links.setAttribute(\"media\", \"all\");\n    $($(\"head\")[0]).append(links);\n    var cookes = document.cookie;\n    var cookData = cookes.split(\";\");\n\n    var dataObj = {};\n    $.each(cookData, function (ind, val) {\n        var arrays = val.split(\"=\");\n        dataObj[arrays[0].trim()] = arrays[1];\n    });\n    if (dataObj.user) {\n        $(\"#jl-login-adm\").val(dataObj.user);\n        $(\"#jl-login-pw\").val(\"\");\n    } else {\n        $(\"#jl-login-adm\").val('');\n        $(\"#jl-login-pw\").val('');\n    }\n    var login_page = {};\n    login_page.login_init = function (isPoint) {\n        var $user_input = $('#jl-login-adm');\n        var $password_input = $('#jl-login-pw');\n        var $user_adm = $('#jl-lo-adm');\n        var $password_paw = $('#jl-login-paw');\n        $user_input.blur(function () {\n            if ($user_input.val() === '') {\n                $user_adm.css('visibility', 'visible');\n                $('#jl-lo-adm').children('span').html('用户名不能为空');\n            } else {\n                $user_adm.css('visibility', 'hidden');\n                $('#jl-lo-adm').children('span').html();\n            }\n            //                    var user_name = $user_input.val().trim();\n            //                    $.post(\"{:U('Home/Account/ajaxCheckUserName')}\",{user_name:user_name}, function (res) {\n            //                        if(status===0){\n            //                            $user_adm.css('visibility','hidden');\n            //                            $('#jl-lo-adm').children('span').html();\n            //                        }\n            //                        else {\n            //                            $user_adm.css('visibility','visible');\n            //                            $('#jl-lo-adm').children('span').html(res.content);\n            //                        }\n            //                    })\n        });\n        $password_input.blur(function () {\n            //判断是否为空\n            if ($password_input.val() === '') {\n                $password_paw.css('visibility', 'visible');\n                $('#jl-login-paw').children('span').html('密码不能为空');\n            } else {\n                $password_paw.css('visibility', 'hidden');\n                $('#jl-login-paw').children('span').html();\n            }\n        });\n        $('.js-submit-input').on('keydown', function (e) {\n            if (e.keyCode === 13) {\n                $('#js-login-submit').trigger('click');\n            }\n        });\n        //用户登录\n        $('#js-login-submit').on('click', function () {\n            var index = layer.load();\n            var user = $.trim($user_input.val());\n            var password = $password_input.val();\n            if ($user_input.val() === '' && $password_input.val() === '') {\n                $user_adm.css('visibility', 'visible');\n                $('#jl-lo-adm').children('span').html('用户名不能为空');\n                $password_paw.css('visibility', 'visible');\n                $('#jl-login-paw').children('span').html('密码不能为空');\n            } else {\n                var data = {\n                    user_name: user,\n                    user_pass: password\n                };\n                var isremenber = $(\".jl-forget-pw\").find(\"input[type=checkbox]:checked\").val();\n                $.post(\"/Home/Account/login\", data, function (res) {\n                    debugger;\n                    if (res.status === 0) {\n                        if (isPoint) {\n                            login_fn();return;\n                        }\n                        var name_show = res.data['user_type'] === \"1\" ? res.data['nick_name'] || res.data['company_name'] : res.data['company_name'] || res.data['nick_name'];\n                        $(\".jl-head-left .js-register\").remove();\n                        $(\".jl-head-left .js-login\").remove();\n                        $(\".jl-head-left\").append('<a class=\"jl-user-name\" href=\"/Home/User/index\">' + name_show + '</a><a class=\"js-login\" href=\"/Home/Account/Logout\">退出</a>');\n                        layer.closeAll();\n                        layer.msg('登陆成功', { icon: 6 });\n                        if (isremenber) {\n                            var times = new Date();\n                            times.setTime(times.getTime() + 30 * 24 * 3600 * 1000);\n                            var str = \"user=\" + user + \";Expires=\" + times.toGMTString();\n                            document.cookie = str;\n                            //document.cookie=\"password=\"+res.data.password+\";Expires=\"+times.toGMTString();\n                        };\n                        /*if(res.data){\r\n                            $(\"#js-login-submit\").css(\"display\",\"none\");\r\n                            $(\".js-company,.js-person\").css(\"display\",\"block\");\r\n                            $(\".js-company\").attr(\"data-id\",res.data['company']['user_id']);\r\n                            $(\".js-person\").attr(\"data-id\",res.data['personal']['user_id']);\r\n                            layer.msg('登陆成功',{icon:6});\r\n                        }\r\n                        else{\r\n                          }*/\n                    } else {\n                        layer.close(index);\n                        if (res.status === 1200 || res.status === 3000 || res.data === 1102) {\n                            $password_paw.css('visibility', 'visible');\n                            $('#jl-login-paw').children('span').html(res.content);\n                        } else {\n                            $password_paw.css('visibility', 'visible');\n                            $('#jl-login-paw').children('span').html('用户名或密码错误');\n                        }\n                    }\n                });\n            }\n        });\n        //选择账号\n        $(\".js-company,.js-person\").on(\"click\", function () {\n            var user = $.trim($user_input.val());\n            var password = $password_input.val();\n            var user_id = $(this).attr(\"data-id\");\n            var ischeck = $(\".jl-forget-pw\").find(\"input:checked\").val();\n            if ($user_input.val() === '' && $password_input.val() === '') {\n                $user_adm.css('visibility', 'visible');\n                $('#jl-lo-adm').children('span').html('用户名不能为空');\n                $password_paw.css('visibility', 'visible');\n                $('#jl-login-paw').children('span').html('密码不能为空');\n            } else {\n                var data = {\n                    user_name: user,\n                    user_pass: password,\n                    user_id: user_id\n                };\n                $.post(\"{:U('Home/Account/login')}\", data, function (res) {\n                    if (res.status === 0) {\n                        /*if(ischeck){\r\n                            var nows = new Date();\r\n                            nows.setDate(nows.getTime()+30*24*3600*1000);\r\n                            document.cookie='user_name='+user+';expires='+now.toUTCString;\r\n                        };*/\n                        location.href = '{:U(\"Home/Default/index\")}';\n                    } else {\n                        if (res.status === 1200) {\n                            $password_paw.css('visibility', 'visible');\n                            $('#jl-login-paw').children('span').html(res.content);\n                        } else if (res.status === 3000) {\n                            $password_paw.css('visibility', 'visible');\n                            $('#jl-login-paw').children('span').html(res.content);\n                        } else {\n                            $password_paw.css('visibility', 'visible');\n                            $('#jl-login-paw').children('span').html('用户名或密码错误');\n                        }\n                    }\n                });\n            }\n        });\n    };\n    //登录框html\n    login_page.login_html = '<div class=\"jl-login-wrap\" style=\"background-color:#091C3D\">\\n' + '        <div class=\"jl-login-item\" style=\"width:100%\">\\n' + '            <!--loginmsg-->\\n' + '            <div class=\"jl-login-msg\" style=\"position:static\">\\n' + '                <div class=\"jl-login-de jl-cle\">\\n' + '                    <h2 class=\"jl-login-tit\">密码登录</h2>\\n' + '                    <form method=\"post\">\\n' + '                        <div class=\"jl-login-item\">\\n' + '                            <label for=\"jl-login-adm\" class=\"jl-lab jl-bg01\"></label>\\n' + '                            <input type=\"text\" id=\"jl-login-adm\" class=\"jl-login-user js-next-input\" tabindex=\"1\" placeholder=\"请输入用户名或手机号\">\\n' + '                        </div>\\n' + '                        <div class=\"jl-login-check\" id=\"jl-lo-adm\">\\n' + '                            <i class=\"jl-lo-bg\"></i>\\n' + '                            <span></span>\\n' + '                        </div>\\n' + '                        <div class=\"jl-login-item\">\\n' + '                            <label for=\"jl-login-pw\" class=\"jl-lab jl-bg02\"></label>\\n' + '                            <input type=\"password\" id=\"jl-login-pw\" class=\"jl-login-user js-next-input js-submit-input\" tabindex=\"2\" placeholder=\"请输入密码\">\\n' + '                        </div>\\n' + '                        <div class=\"jl-login-check\" id=\"jl-login-paw\">\\n' + '                            <i class=\"jl-lo-bg\"></i>\\n' + '                            <span></span>\\n' + '                        </div>\\n' + '                        <div class=\"jl-login-item jl-login-for\">\\n' + '                            <span class=\"jl-forget-pw\" style=\"float:left\"><s ><input type=\"checkbox\" value=\"1\" checked/><s>记住账号</s></s></span>\\n' + '                            <span class=\"jl-forget-pw\"><a href=\"{:U(\\'Home/Account/passForget\\')}\">忘记密码</a></span>\\n' + '                        </div>\\n' + '                        <!--<div class=\"jl-login-item jl-login-btn\">-->\\n' + '                            <input id=\"js-login-submit\" class=\"js-next-input\" type=\"button\" value=\"登 录\">\\n' + '                        <!--</div>-->\\n' + '                    </form>\\n' + '                    <button class=\"js-company\">企业账号登录</button>\\n' + '                    <button class=\"js-person\">个人账号登录</button>\\n' + '                </div>\\n' + '                <div class=\"jl-choose\">\\n' + '                    <ul class=\"jl-choose-de jl-cle\">\\n' + '                        <li>\\n' + '                            <a href=\"/Home/Account/login?type=qq\" class=\"jl-way\">\\n' + '                                <b class=\"jl-choose-qq-bg\"></b>\\n' + '                            </a>\\n' + '                        </li>\\n' + '                        <li>\\n' + '                            <a href=\"/Home/Account/login?type=wechat\" class=\"jl-way\">\\n' + '                                <b class=\"jl-choose-weiXin\"></b>\\n' + '                            </a>\\n' + '                        </li>\\n' + '                        <li>\\n' + '                            <a href=\"/Home/Account/login?type=sina\" class=\"jl-way\">\\n' + '                                <b class=\"jl-choose-weiBo\"></b>\\n' + '                            </a>\\n' + '                        </li>\\n' + '                        <li class=\"jl-last-choose\">\\n' + '                            <a href=\"/Home/Account/register\" class=\"jl-run-reg\">\\n' + '                                <b></b>\\n' + '                                <span>立即注册</span>\\n' + '                            </a>\\n' + '                        </li>\\n' + '                    </ul>\\n' + '                </div>\\n' + '            </div>\\n' + '        </div>\\n' + '    </div>';\n    window.login_page = login_page;\n});"]}