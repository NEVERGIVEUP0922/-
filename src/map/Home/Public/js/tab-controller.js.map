{"version":3,"sources":["Home/Public/js/tab-controller.js"],"names":["layui","define","t","l","element","i","layer","s","n","tabFilter","refreshInterval","a","c","icon","title","d","window","sessionStorage","getItem","$","parseJSON","isArray","f","each","e","String","id","tabDelete","splice","setItem","JSON","stringify","r","attr","data","init","extend","tabAdd","content","url","tabChange","on","children","eq","index","stopPropagation","this","parent","go","contentWindow","location","pathname","search","href","Date","getTime","o","length","shift","push","refresh","setTimeout","get","reload","toFixed","msg","deleteTabs","filter","indexOf","deleteTab","getTabs"],"mappings":"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","file":"../../../../../temporaryJs/Home/Public/js/tab-controller.js","sourcesContent":["\"use strict\";\nlayui.define([\"element\", \"layer\"], function (t) {\n  var l = layui.element,\n      i = layui.layer,\n      s = {},\n      n = { tabFilter: \"tabController\", refreshInterval: 500 },\n      a = !0,\n      c = function c(t) {\n    return (t.icon ? '<i class=\"iconfont-jl icon-jl-' + t.icon + '\"></i>' : \"\") + \"<cite>\" + t.title + '</cite><i class=\"tab-controller-close iconfont-jl icon-jl-close\"></i>';\n  },\n      d = function d() {\n    var t = window.sessionStorage.getItem(\"tabs\");if (null !== t) {\n      try {\n        t = $.parseJSON(t);\n      } catch (t) {}if ($.isArray(t)) return t;\n    }return [];\n  },\n      f = function f(i, a) {\n    var t = d();a || $.each(t, function (t, e) {\n      if (String(e.id) === String(i)) return a = t, !1;\n    }), l.tabDelete(s.tabFilter, i), t.splice(a, 1), window.sessionStorage.setItem(\"tabs\", JSON.stringify(t));\n  },\n      r = function r(t) {\n    var e = $(\".jl-\" + t);e.attr(\"src\") || e.attr(\"src\", e.data(\"src\"));\n  };t(\"tabController\", { init: function init(t) {\n      $.extend(s, n, t);var e = d(),\n          a = window.sessionStorage.getItem(\"active_tab_id\");$.each(e, function (t, e) {\n        var i = c(e);l.tabAdd(s.tabFilter, { title: i, content: \"<iframe data-src='\" + e.url + \"' data-id='\" + e.id + \"' class='jl-\" + e.id + \"'></frame>\", id: e.id }), String(e.id) === a && (r(e.id), l.tabChange(s.tabFilter, e.id));\n      });var i = $(\".layui-tab[lay-filter=\" + s.tabFilter + \"]\");l.on(\"tab(\" + s.tabFilter + \")\", function (t) {\n        var e = i.children(\".layui-tab-title\").children(\"li\").eq(t.index).attr(\"lay-id\");r(e), window.sessionStorage.setItem(\"active_tab_id\", e);\n      }), i.on(\"click\", \".tab-controller-close\", function (t) {\n        t.stopPropagation();var e = $(this).parent(\"li\"),\n            i = e.attr(\"lay-id\"),\n            a = e.index() - 1;f(i, a);\n      });\n    }, go: function go(i) {\n      var a = !1,\n          n = !1,\n          t = d();if ($.each(t, function (t, e) {\n        if (e.title === i.title) return a = e.id, n = t, !1;\n      }), a) {\n        l.tabChange(s.tabFilter, a);var e = $(\"iframe[data-id=\" + a + \"]\"),\n            r = e[0].contentWindow.location;r.pathname + r.search !== i.url && (e[0].contentWindow.location.href = i.url), window.sessionStorage.setItem(\"active_tab_id\", JSON.stringify(a)), t[n].url = i.url;\n      } else {\n        i.id = new Date().getTime();var o = c(i);l.tabAdd(s.tabFilter, { title: o, content: \"<iframe src='\" + i.url + \"' data-id='\" + i.id + \"'></frame>\", id: i.id }), l.tabChange(s.tabFilter, i.id), 8 < t.length && (f(t[0].id, 0), t.shift()), t.push(i), window.sessionStorage.setItem(\"active_tab_id\", JSON.stringify(i.id));\n      }window.sessionStorage.setItem(\"tabs\", JSON.stringify(t));\n    }, refresh: function refresh() {\n      if (a) {\n        a = !1, setTimeout(function () {\n          a = !0;\n        }, s.refreshInterval);var t = window.sessionStorage.getItem(\"active_tab_id\");t = t || \"default\", $(\"iframe[data-id=\" + t + \"]\").get(0).contentWindow.location.reload(!0);\n      } else {\n        var e = (s.refreshInterval / 1e3).toFixed(1);i.msg(\"点击速度超越了服务器的响应速度<br/>还是等\" + e + \"秒再刷新吧！\");\n      }\n    }, deleteTabs: function deleteTabs(i) {\n      if ($.isArray(i)) {\n        var t = d(),\n            a = 0;t = t.filter(function (t, e) {\n          return !(-1 < i.indexOf(String(t.id)) && (setTimeout(function () {\n            l.tabDelete(s.tabFilter, t.id);\n          }, 60 * a), a++, 1));\n        }), window.sessionStorage.setItem(\"tabs\", JSON.stringify(t));\n      } else f(i);\n    }, deleteTab: f, getTabs: d });\n});"]}