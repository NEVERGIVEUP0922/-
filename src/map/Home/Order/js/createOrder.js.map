{"version":3,"sources":["Home/Order/js/createOrder.js"],"names":["define","$","address","modal","setInput","$input","type","msg","addClass","siblings","removeClass","on","$this","this","value","trim","val","pat","RegExp","name","hasClass","length","test","setAddress","init","data","add_url","origin_data","_this","$list","$empty","$addBox","hide","show","active","each","index","el","status","address_html","builtAddressHtml","html","short_html","builtShortHtml","find","isPass","post","res","parseJSON","error","address_id","children","push","new_html","append","alert","title","id","String","consignee","mobile","getData","area_code","join","invoice","$list_special","$list_ordinary","$add_btn","$add_text","$addBox_special","$addBox_ordinary","special_array","ordinary_array","invoice_type","special_html","ordinary_html","builtInvoiceHtml","invoice_id","special","company_area_code","company_address","company_phone","company_tax_code","company_bank_name","company_bank_acount","invoice_header","invoice_owner"],"mappings":"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","file":"../../../../../temporaryJs/Home/Order/js/createOrder.js","sourcesContent":["'use strict';\n\ndefine(['jquery', 'Toolkit/handle-district', 'jl-modal'], function ($, address, modal) {\n    var setInput = function setInput($input, type, msg) {\n        if (type === 'error') {\n            $input.addClass('js-input-error').siblings('.jl-input-error-icon').addClass('jl-cur');\n        } else if (type === 'pass') {\n            $input.removeClass('js-input-error').siblings('.jl-input-error-icon').removeClass('jl-cur');\n        }\n    };\n    $('.js-check-input').on('blur', function () {\n        var $this = $(this);\n        var value = $.trim($this.val());\n        var pat = new RegExp(\"^(\\\\-|\\\\+)?\\\\d+(\\\\-\\\\d+)?$\");\n        if (value === '') {\n            setInput($this, 'error', this.name + '不可为空');\n        } else if ($this.hasClass('js-check-input-phone') && value.length !== 11) {\n            setInput($this, 'error', this.name + '格式不对');\n        } else if ($this.hasClass('js-check-input-phone-2') && !pat.test(value)) {\n            setInput($this, 'error', this.name + '格式不对');\n        } else {\n            setInput($this, 'pass');\n        }\n    });\n    var setAddress = function setAddress($input, type, msg) {\n        if (type === 'error') {\n            $input.siblings('.jl-input-error-icon').addClass('jl-cur').siblings('.jl-y-select').addClass('js-input-error');\n        } else if (type === 'pass') {\n            $input.siblings('.jl-input-error-icon').removeClass('jl-cur').siblings('.jl-y-select').removeClass('js-input-error');\n        }\n    };\n    $('.jl-check-address').on('change', function () {\n        var $this = $(this);\n        var value = $.trim($this.val());\n        if (value === '') {\n            setAddress($this, 'error');\n        } else {\n            setAddress($this, 'pass');\n        }\n    });\n    return {\n        address: {\n            init: function init(data, add_url) {\n                var origin_data = data;\n                var _this = this;\n                var $list = $('.js-address-list');\n                var $empty = $('.js-address-empty');\n                var $addBox = $('.js-popup-consignee');\n                if (origin_data && origin_data.length && origin_data.length !== 0) {\n                    $empty.hide();\n                    $list.show();\n                    origin_data[0].active = true;\n                    $.each(origin_data, function (index, el) {\n                        var status = el.status;\n                        if (status === '1') {\n                            origin_data[0].active = false;\n                        }\n                    });\n                    var address_html = _this.builtAddressHtml(origin_data);\n                    $list.html(address_html);\n                    var short_html = _this.builtShortHtml(origin_data[0]);\n                    $('.js-selected-address').html(short_html);\n                } else {\n                    $empty.show();$list.hide();\n                }\n                //添加按钮\n                $('.js-address-add').on('click', function () {\n                    $addBox.show();\n                });\n                //关闭按钮\n                $addBox.find('.jl-close').on('click', function () {\n                    $addBox.hide();\n                });\n                //提交按钮\n                $addBox.find('.jl-popup-submit').on('click', function () {\n                    var isPass = true;\n                    var data = {};\n                    $addBox.find('input').each(function () {\n                        var $this = $(this);\n                        var value = $.trim($this.val());\n                        if (value === '') {\n                            if (this.name === 'company_area') {\n                                setAddress($this, 'error');\n                            } else {\n                                setInput($this, 'error', this.name + '不可为空');\n                            }\n                            // $this.focus();\n                            isPass = false;\n                        } else if (this.name === 'mobile' && value.length !== 11) {\n                            setInput($this, 'error');\n                            // $this.focus();\n                            isPass = false;\n                        }\n                        data[this.name] = value;\n                    });\n                    data['area_code'] = data['company_area'];\n                    if (isPass) {\n                        $.post(add_url, data, function (res) {\n                            res = $.parseJSON(res);\n                            if (res.error === 0) {\n                                $addBox.hide();\n                                data['id'] = res.data.address_id;\n                                if ($list.children().length === 0) {\n                                    data['active'] = true;\n                                    var short_html = _this.builtShortHtml(data);\n                                    $('.js-selected-address').html(short_html);\n                                }\n                                origin_data.push(data);\n                                var new_html = _this.builtAddressHtml(data);\n                                $list.append(new_html);\n                                $empty.hide();\n                                $list.show();\n                            } else {\n                                modal.alert({\n                                    title: res.msg\n                                });\n                            }\n                        });\n                    }\n                });\n                //地址选择\n                $list.on('click', '.jl-consignee-title', function () {\n                    $('.jl-consignee-title').removeClass('jl-cur');\n                    $(this).addClass('jl-cur');\n                    var id = String($(this).data('id'));\n                    $.each(origin_data, function (index, value) {\n                        if (value.id === id) {\n                            var html = _this.builtShortHtml(value);\n                            $('.js-selected-address').html(html);\n                            return false;\n                        }\n                    });\n                });\n            },\n            builtShortHtml: function builtShortHtml(value) {\n                return '<span>收货人：' + value.consignee + ' ' + value.mobile + '</span>\\n' + '<span>' + address.getData(value.area_code).join(' ') + ' ' + value.address + '</span>\\n';\n            },\n            builtAddressHtml: function builtAddressHtml(data) {\n                if (!data.length) {\n                    data = [data];\n                }\n                var html = '';\n                $.each(data, function (index, value) {\n                    html += '<li>\\n' + '<p data-id=\"' + value.id + '\" data-code=\"' + value.area_code + '\" class=\"jl-consignee-title ' + (value.status === '1' ? 'jl-cur' : value.active ? 'jl-cur' : '') + '\">' + value.consignee + '<i></i>' + '</p>\\n' + '<span class=\"jl-consignee-name\">' + value.consignee + '</span>\\n' + '<span class=\"jl-consignee-addr\">' + address.getData(value.area_code).join(' ') + ' ' + value.address + '</span>\\n' + '<span class=\"jl-consignee-phone\">' + value.mobile + '</span>\\n' + '</li>';\n                });\n                return html;\n            }\n        },\n        invoice: {\n            init: function init(data, add_url) {\n                var _this = this;\n                var $list_special = $('.jl-special-invoice');\n                var $list_ordinary = $('.jl-ordinary-invoice');\n                var $add_btn = $('.jl-no-invoice');\n                var $add_text = $('.js-add-invoice');\n                var $addBox_special = $('.js-popup-special');\n                var $addBox_ordinary = $('.js-popup-ordinary');\n                var special_array = [];\n                var ordinary_array = [];\n                $.each(data, function (index, value) {\n                    if (value.invoice_type === '1') {\n                        special_array.push(value);\n                    } else {\n                        ordinary_array.push(value);\n                    }\n                });\n                var special_html = '';\n                var ordinary_html = '';\n                if (special_array.length !== 0) {\n                    special_array[0]['active'] = true;\n                    special_html = _this.builtInvoiceHtml(special_array, 1);\n                    $list_special.html(special_html);\n                }\n                if (ordinary_array.length !== 0) {\n                    ordinary_array[0]['active'] = true;\n                    ordinary_html = _this.builtInvoiceHtml(ordinary_array, 2);\n                    $list_ordinary.html(ordinary_html);\n                }\n                //选择类型\n                $('.jl-invoice-class li').on('click', function () {\n                    $(this).addClass('jl-cur').siblings().removeClass('jl-cur');\n                    var index = $(this).index();\n                    $list_special.hide();\n                    $list_ordinary.hide();\n                    $add_btn.hide();\n                    $add_text.hide();\n                    if (index !== 0) {\n                        var $list = index === 1 ? $list_special : $list_ordinary;\n                        $list.show();\n                        $add_text.show();\n                        if ($list.children().length === 0) {\n                            $add_btn.show();\n                        }\n                    }\n                });\n                //添加按钮\n                $add_text.on('click', function () {\n                    var index = $('.jl-invoice-class .jl-cur').index();\n                    if (index === 1) {\n                        $addBox_special.show();\n                    } else if (index === 2) {\n                        $addBox_ordinary.show();\n                    }\n                });\n                //关闭按钮\n                $addBox_special.find('.jl-close').on('click', function () {\n                    $addBox_special.hide();\n                });\n                $addBox_ordinary.find('.jl-close').on('click', function () {\n                    $addBox_ordinary.hide();\n                });\n                //专票提交\n                $addBox_special.find('.jl-popup-submit').on('click', function () {\n                    var isPass = true;\n                    var data = {};\n                    $addBox_special.find('input').each(function () {\n                        var $this = $(this);\n                        var value = $(this).val().trim();\n                        var pat = new RegExp(\"^(\\\\-|\\\\+)?\\\\d+(\\\\-\\\\d+)?$\");\n\n                        if (this.name === 'company_phone') {\n                            var a = pat.test(value);\n                        }\n\n                        if (value === '') {\n                            if (this.name === 'company_area_code' || this.name === 'area_code') {\n                                setAddress($this, 'error');\n                            } else {\n                                setInput($this, 'error', this.name + '不可为空');\n                            }\n                            // $this.focus();\n                            isPass = false;\n                            // return false\n                        } else if (this.name === 'company_phone' && !pat.test(value)) {\n                            setInput($this, 'error');\n                            // $this.focus();\n                            isPass = false;\n                            // return false\n                        } else if (this.name === 'mobile' && value.length !== 11) {\n                            setInput($this, 'error');\n                            // $this.focus();\n                            isPass = false;\n                            // return false\n                        }\n                        data[this.name] = value;\n                    });\n                    if (isPass) {\n                        data['invoice_type'] = 1;\n                        $.post(add_url, data, function (res) {\n                            res = $.parseJSON(res);\n                            if (res.error === 0) {\n                                $addBox_special.hide();\n                                data['id'] = res.data.invoice_id;\n                                if ($list_special.children().length === 0) {\n                                    data['active'] = true;\n                                }\n                                var new_html = _this.builtInvoiceHtml(data, 1);\n                                $list_special.append(new_html);\n                                $add_btn.hide();\n                            } else {\n                                modal.alert({\n                                    title: res.msg\n                                });\n                            }\n                        });\n                    }\n                });\n                //普票提交\n                $addBox_ordinary.find('.jl-popup-submit').on('click', function () {\n                    var isPass = true;\n                    var data = {};\n                    $addBox_ordinary.find('input').each(function () {\n                        var $this = $(this);\n                        var value = $this.val().trim();\n                        if (value === '') {\n                            if (this.name === 'area_code') {\n                                setAddress($this, 'error');\n                            } else {\n                                setInput($this, 'error', this.name + '不可为空');\n                            }\n                            // $(this).focus();\n                            isPass = false;\n                            // return false\n                        } else if (this.name === 'mobile' && value.length !== 11) {\n                            setInput($this, 'error');\n                            // $this.focus();\n                            isPass = false;\n                            // return false\n                        }\n                        data[this.name] = value;\n                    });\n                    if (isPass) {\n                        data['invoice_type'] = 2;\n                        $.post(add_url, data, function (res) {\n                            res = $.parseJSON(res);\n                            if (res.error === 0) {\n                                $addBox_ordinary.hide();\n                                data['id'] = res.data.invoice_id;\n                                if ($list_ordinary.children().length === 0) {\n                                    data['active'] = true;\n                                }\n                                var new_html = _this.builtInvoiceHtml(data, 2);\n                                $list_ordinary.append(new_html);\n                                $add_btn.hide();\n                            } else {\n                                modal.alert({\n                                    title: res.msg\n                                });\n                            }\n                        });\n                    }\n                });\n                //发票选择\n                $list_special.on('click', 'li', function () {\n                    $(this).addClass('jl-cur').siblings().removeClass('jl-cur');\n                });\n                $list_ordinary.on('click', 'li', function () {\n                    $(this).addClass('jl-cur').siblings().removeClass('jl-cur');\n                });\n            },\n            builtInvoiceHtml: function builtInvoiceHtml(data, type) {\n                if (!data.length) {\n                    data = [data];\n                }\n                var html = '';\n                $.each(data, function (index, value) {\n                    var special = type === 1 ? '    <div class=\"jl-special-phone\">\\n' + '        <p class=\"jl-ordinary-title\">地址、电话:</p>\\n' + '        <p class=\"jl-ordinary-addr\">\\n' + '            <span class=\"jl-ordinary-name\">' + address.getData(value.company_area_code).join(' ') + ' ' + value.company_address + '            </span>\\n' + '            <span class=\"jl-ordinary-telephone\">' + value.company_phone + '</span>\\n' + '        </p>\\n' + '    </div>\\n' + '    <div class=\"jl-special-number\">\\n' + '        <p class=\"jl-ordinary-title\">税务登记号:</p>\\n' + '        <p class=\"jl-ordinary-name\">' + value.company_tax_code + '</p>\\n' + '    </div>\\n' + '    <div class=\"jl-special-bank\">\\n' + '        <p class=\"jl-ordinary-title\">开户行、账号:</p>\\n' + '        <p class=\"jl-ordinary-addr\">\\n' + '            <span class=\"jl-ordinary-name\">' + value.company_bank_name + '</span>\\n' + '            <span class=\"jl-ordinary-telephone\">' + value.company_bank_acount + '</span>\\n' + '        </p>\\n' + '    </div>\\n' : '';\n                    html += '<li data-id=\"' + value.id + '\" class=\"' + (value.active ? 'jl-cur' : '') + '\">\\n' + '    <div class=\"jl-ordinary-top\">\\n' + '        <p class=\"jl-ordinary-title\">发票抬头:</p>\\n' + '        <p class=\"jl-ordinary-name\">' + value.invoice_header + '</p>\\n' + '    </div>\\n' + special + '    <div class=\"jl-ordinary-bottom\">\\n' + '        <p class=\"jl-ordinary-title\">收票人信息:</p>\\n' + '        <p class=\"jl-ordinary-addr\">\\n' + '            <span class=\"jl-ordinary-name\">' + value.invoice_owner + '</span>\\n' + '            <span class=\"jl-ordinary-news\">' + address.getData(value.area_code).join(' ') + ' ' + value.address + '            </span>\\n' + '            <span class=\"jl-ordinary-phone\">' + value.mobile + '</span>\\n' + '        </p>\\n' + '    </div>\\n' + '    <i></i>\\n' + '</li>';\n                });\n                return html;\n            }\n        }\n    };\n});"]}