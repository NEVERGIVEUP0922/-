<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache,no-store,must-revalidate">
    <meta http-equiv="Expires" content="0">
    <meta name="renderer" content="webkit">
    <title><block name="title"></block> - 玖隆商城后台管理系统</title>
    <link href="__PUBLIC__/Common/module/layui/2.0.2/css/layui.css" rel="stylesheet" />
    <link href="//at.alicdn.com/t/font_tnyc012u2rlwstt9.css" media="all" rel="stylesheet" />
    <script src="__PUBLIC__/Common/module/1.11.3/jquery.min.js" type="text/javascript"></script>
    <script src="__PUBLIC__/Admin/js/pjax.js" type="text/javascript"></script>
    <script src="__PUBLIC__/Common/module/layui/2.0.2/layui.js" type="text/javascript"></script>
    <block name="css"></block>
</head>
<body>
<nav class="nav navbar-default navbar-mystyle navbar-fixed-top">
    <div class="navbar-header">
        <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand mystyle-brand"><span class="glyphicon glyphicon-home"></span></a> </div>
    <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
            <li class="li-border"><a class="mystyle-color" href="#">管理控制台</a></li>
            <li class="li-border"><a class="mystyle-color" href="#">商品管理</a></li>
            <li class="dropdown li-border"><a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown">产品与服务<span class="caret"></span></a>
                <!----下拉框选项---->
                <div class="dropdown-menu topbar-nav-list">
                    <div class="topbar-nav-col">
                        <div class="topbar-nav-item">
                            <p class="topbar-nav-item-title">弹性计算</p>
                            <ul>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-road"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-picture"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-gift"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                            </ul>
                        </div>

                        <div class="">
                            <p class="topbar-nav-item-title">弹性计算</p>
                            <ul>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-road"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-picture"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-gift"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                            </ul>
                        </div>
                    </div>


                    <div class="topbar-nav-col">
                        <div class="topbar-nav-item">
                            <p class="topbar-nav-item-title">弹性计算</p>
                            <ul>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-road"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-picture"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-gift"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                            </ul>
                        </div>

                        <div class="">
                            <p class="topbar-nav-item-title">弹性计算</p>
                            <ul>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-road"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-picture"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                                <li><a href="#">
                                    <span class="glyphicon glyphicon-gift"></span>
                                    <span class="">云服务器 ECS</span>
                                </a>
                                </li>
                            </ul>
                        </div>

                    </div>

                </div>
            </li>
        </ul>

        <ul class="nav navbar-nav pull-right">
            <li class="li-border">
                <a href="#" class="mystyle-color">
                    <span class="glyphicon glyphicon-bell"></span>
                    <span class="topbar-num">0</span>
                </a>
            </li>
            <li class="li-border dropdown"><a href="#" class="mystyle-color" data-toggle="dropdown">
                <span class="glyphicon glyphicon-search"></span> 搜索</a>
                <div class="dropdown-menu search-dropdown">
                    <div class="input-group">
                        <input type="text" class="form-control">
                        <span class="input-group-btn">
                   <button type="button" class="btn btn-default">搜索</button>
                </span>
                    </div>
                </div>
            </li>
            <li class="dropdown li-border"><a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown">帮助与文档<span class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li><a href="#">帮助与文档</a></li>
                    <li class="divider"></li>
                    <li><a href="#">论坛</a></li>
                    <li class="divider"></li>
                    <li><a href="#">博客</a></li>
                </ul>
            </li>
            <li class="dropdown li-border"><a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown">{:session('adminInfo.user_name')}<span class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li><a id="jl-admin-logout">退出</a></li>
                </ul>
            </li>
            <li class="dropdown"><a href="#" class="dropdown-toggle mystyle-color" data-toggle="dropdown">换肤<span class="caret"></span></a>
                <ul class="dropdown-menu changecolor">
                    <li id="blue"><a href="#">蓝色</a></li>
                    <li class="divider"></li>
                    <li id="green"><a href="#">绿色</a></li>
                    <li class="divider"></li>
                    <li id="orange"><a href="#">橙色</a></li>
                </ul>
            </li>
        </ul>
    </div>
</nav>
<div class="down-main">
    <div class="left-main left-full">
        <div class="sidebar-fold"><span class="glyphicon glyphicon-menu-hamburger"></span></div>
        <div class="subNavBox" id="leftMenu">
        </div>
    </div>
    <div id="main-content">
        {__CONTENT__}
    </div>
</div>
<script type="text/javascript">
    $(function(){
        var pjaxdiv = '#main-content';
        $(document).pjax('#leftMenu ul.navContent li a', pjaxdiv)
        $(document).on('pjax:send', function() {
            $(pjaxdiv).fadeOut(10)
        })
        $(document).on('pjax:complete', function() {
            $(pjaxdiv).fadeIn(300)
        })
        $('#leftMenu').on('click','ul.navContent li', function(){
            $(this).addClass('active').siblings().removeClass('active');
        });
        /*获取菜单*/
        $.ajax({
            url:'{:U("Admin/Index/getMenu")}',
            type:'post',
            dataType:'json',
            success:function(data){
                if( data !== '' ){
                    var num = data.length;
                    var str= '';
                    for( var i=0; i < num ; i++ ){
                        var status = data[i].status, name = data[i].name, child=data[i]['child'] , childNum = child.length, point, dis;
                        if( status == 'open' ){
                            point = 'up';
                            dis = 'display:block';
                        }else if( status == 'close' ){
                            point = 'down';
                            dis = 'display:none';
                        }
                        str += '<div class="sBox">';
                        str += '<div class="subNav sublist-'+ point +'">';
                        str += '<span class="title-icon glyphicon glyphicon-chevron-'+ point +'">';
                        str += '</span><span class="sublist-title">'+  name +'</span></div>';
                        str += '<ul class="navContent" style="'+ dis +'">';
                            for( var j=0; j< childNum; j++ ){
                                var na = child[j].name, href = child[j].href, icon = child[j].icon;
                                if( i == 0 && j == 0){
                                    str += '<li class="active">';
                                }else{
                                    str += '<li>';
                                }
                                str += '<div class="showtitle" style="width:100px;"><img src="__PUBLIC__/Admin/img/leftimg.png" />'+ na +'</div>';
                                str += '<a href="'+ href +'"><span class="sublist-icon glyphicon glyphicon-'+ icon +'"></span><span class="sub-title">'+ na +'</span>';
                                str += '</a></li>';
                            }
                        str += '</ul>';
                        str += '</div>';
                    }
                    $('div#leftMenu').append(str);
                }
            },
        });

        /*换肤*/
        $(".dropdown .changecolor li").click(function(){
            var style = $(this).attr("id");
            $("link[title!='']").attr("disabled","disabled");
            $("link[title='"+style+"']").removeAttr("disabled");

            $.cookie('mystyle', style, { expires: 7 }); // 存储一个带7天期限的 cookie
        })
        var cookie_style = $.cookie("mystyle");
        if(cookie_style!=null){
            $("link[title!='']").attr("disabled","disabled");
            $("link[title='"+cookie_style+"']").removeAttr("disabled");
        }
        /*左侧导航栏显示隐藏功能*/
        $("#leftMenu").on('click','.subNav',function(){
            /*显示*/
            if($(this).find("span:first-child").attr('class')=="title-icon glyphicon glyphicon-chevron-down")
            {
                $(this).find("span:first-child").removeClass("glyphicon-chevron-down");
                $(this).find("span:first-child").addClass("glyphicon-chevron-up");
                $(this).removeClass("sublist-down");
                $(this).addClass("sublist-up");
            }
            /*隐藏*/
            else
            {
                $(this).find("span:first-child").removeClass("glyphicon-chevron-up");
                $(this).find("span:first-child").addClass("glyphicon-chevron-down");
                $(this).removeClass("sublist-up");
                $(this).addClass("sublist-down");
            }
            // 修改数字控制速度， slideUp(500)控制卷起速度
            $(this).next(".navContent").slideToggle(300).siblings(".navContent").slideUp(500);
        })
        /*左侧导航栏缩进功能*/
        $(".left-main .sidebar-fold").on('click',function(){

            if($(this).parent().attr('class')=="left-main left-full")
            {
                $(this).parent().removeClass("left-full");
                $(this).parent().addClass("left-off");

                $(this).parent().parent().find(".right-product").removeClass("right-full");
                $(this).parent().parent().find(".right-product").addClass("right-off");

            }
            else
            {
                $(this).parent().removeClass("left-off");
                $(this).parent().addClass("left-full");

                $(this).parent().parent().find(".right-product").removeClass("right-off");
                $(this).parent().parent().find(".right-product").addClass("right-full");

            }
        })

        /*左侧鼠标移入提示功能*/
        $("#leftMenu").on('mouseenter','.sBox ul li',function(){
            if($(this).find("span:last-child").css("display")=="none")
            {$(this).find("div").show();}
        }).on('mouseleave','.sBox ul li',function(){$(this).find("div").hide();})

        $('#jl-admin-logout').on('click', function () {
            layer.confirm('您确定要退出吗？', {
                btn: ['确定','返回'] //按钮
            }, function(){
                location.href='{:U("Admin/Index/logout")}';
            });
        });
    })
</script>
<block name="js"></block>
</body>